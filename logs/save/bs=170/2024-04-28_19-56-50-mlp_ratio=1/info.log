2024-04-28 19:56:50   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=1.0, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=5, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-04-28_19-56-50', seed=0, train_batch_size=170, val_set_names=['msls_val'])
2024-04-28 19:56:50   The outputs are being saved in logs/2024-04-28_19-56-50
2024-04-28 19:56:50   validation dataset names:['msls_val']
2024-04-28 19:56:50   Using 2 GPUs and 64 CPUs
2024-04-28 19:56:50   using MLP layer as FFN
2024-04-28 19:56:54   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-04-28 19:56:54   Start training epoch: 00
2024-04-28 20:16:57   Finished epoch 00 in 0:20:02, average epoch loss = 0.7838
2024-04-28 20:17:58   Ranking results: msls_val R@1: 0.8527, R@5: 0.9297, R@10: 0.9419, R@15: 0.9514, R@20: 0.9541, R@50: 0.9649, R@100: 0.9676
2024-04-28 20:18:00   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8527
2024-04-28 20:18:00   Start training epoch: 01
2024-04-28 20:37:59   Finished epoch 01 in 0:19:59, average epoch loss = 0.4317
2024-04-28 20:38:59   Ranking results: msls_val R@1: 0.8608, R@5: 0.9378, R@10: 0.9486, R@15: 0.9568, R@20: 0.9581, R@50: 0.9649, R@100: 0.9716
2024-04-28 20:39:07   Improved: previous msls-val best R@1 = 0.8527, current R@1 = 0.8608
2024-04-28 20:39:07   Start training epoch: 02
2024-04-28 20:59:06   Finished epoch 02 in 0:19:58, average epoch loss = 0.3660
2024-04-28 21:00:06   Ranking results: msls_val R@1: 0.8824, R@5: 0.9392, R@10: 0.9514, R@15: 0.9608, R@20: 0.9662, R@50: 0.9716, R@100: 0.9743
2024-04-28 21:00:13   Improved: previous msls-val best R@1 = 0.8608, current R@1 = 0.8824
2024-04-28 21:00:13   Start training epoch: 03
2024-04-28 21:20:12   Finished epoch 03 in 0:19:59, average epoch loss = 0.3130
2024-04-28 21:21:13   Ranking results: msls_val R@1: 0.8919, R@5: 0.9446, R@10: 0.9568, R@15: 0.9649, R@20: 0.9662, R@50: 0.9703, R@100: 0.9784
2024-04-28 21:21:20   Improved: previous msls-val best R@1 = 0.8824, current R@1 = 0.8919
2024-04-28 21:21:20   Start training epoch: 04
2024-04-28 21:41:19   Finished epoch 04 in 0:19:59, average epoch loss = 0.2866
2024-04-28 21:42:20   Ranking results: msls_val R@1: 0.8932, R@5: 0.9446, R@10: 0.9554, R@15: 0.9622, R@20: 0.9676, R@50: 0.9730, R@100: 0.9730
2024-04-28 21:42:27   Improved: previous msls-val best R@1 = 0.8919, current R@1 = 0.8932
2024-04-28 21:42:27   Start training epoch: 05
2024-04-28 22:02:27   Finished epoch 05 in 0:19:59, average epoch loss = 0.2674
2024-04-28 22:03:27   Ranking results: msls_val R@1: 0.8892, R@5: 0.9446, R@10: 0.9608, R@15: 0.9649, R@20: 0.9649, R@50: 0.9716, R@100: 0.9770
2024-04-28 22:03:31   Not improved: 1 / 5: msls-val best R@1 = 0.8932, current R@1 = 0.8892
2024-04-28 22:03:31   Start training epoch: 06
2024-04-28 22:23:30   Finished epoch 06 in 0:19:59, average epoch loss = 0.2432
2024-04-28 22:24:31   Ranking results: msls_val R@1: 0.8919, R@5: 0.9459, R@10: 0.9581, R@15: 0.9608, R@20: 0.9649, R@50: 0.9730, R@100: 0.9770
2024-04-28 22:24:34   Not improved: 2 / 5: msls-val best R@1 = 0.8932, current R@1 = 0.8919
2024-04-28 22:24:34   Start training epoch: 07
2024-04-28 22:44:33   Finished epoch 07 in 0:19:59, average epoch loss = 0.2295
2024-04-28 22:45:34   Ranking results: msls_val R@1: 0.8892, R@5: 0.9473, R@10: 0.9595, R@15: 0.9649, R@20: 0.9703, R@50: 0.9743, R@100: 0.9770
2024-04-28 22:45:37   Not improved: 3 / 5: msls-val best R@1 = 0.8932, current R@1 = 0.8892
2024-04-28 22:45:37   Start training epoch: 08
2024-04-28 23:05:37   Finished epoch 08 in 0:20:00, average epoch loss = 0.2194
2024-04-28 23:06:38   Ranking results: msls_val R@1: 0.9027, R@5: 0.9473, R@10: 0.9595, R@15: 0.9662, R@20: 0.9662, R@50: 0.9743, R@100: 0.9770
2024-04-28 23:06:44   Improved: previous msls-val best R@1 = 0.8932, current R@1 = 0.9027
2024-04-28 23:06:44   Start training epoch: 09
2024-04-28 23:26:44   Finished epoch 09 in 0:20:00, average epoch loss = 0.2075
2024-04-28 23:27:45   Ranking results: msls_val R@1: 0.9027, R@5: 0.9432, R@10: 0.9541, R@15: 0.9635, R@20: 0.9662, R@50: 0.9716, R@100: 0.9770
2024-04-28 23:27:48   Not improved: 1 / 5: msls-val best R@1 = 0.9027, current R@1 = 0.9027
2024-04-28 23:27:48   Start training epoch: 10
2024-04-28 23:47:49   Finished epoch 10 in 0:20:00, average epoch loss = 0.1992
2024-04-28 23:48:49   Ranking results: msls_val R@1: 0.8986, R@5: 0.9446, R@10: 0.9554, R@15: 0.9649, R@20: 0.9676, R@50: 0.9689, R@100: 0.9730
2024-04-28 23:48:53   Not improved: 2 / 5: msls-val best R@1 = 0.9027, current R@1 = 0.8986
2024-04-28 23:48:53   Start training epoch: 11
2024-04-29 00:08:53   Finished epoch 11 in 0:19:59, average epoch loss = 0.1918
2024-04-29 00:09:54   Ranking results: msls_val R@1: 0.9000, R@5: 0.9459, R@10: 0.9554, R@15: 0.9649, R@20: 0.9649, R@50: 0.9716, R@100: 0.9784
2024-04-29 00:09:58   Not improved: 3 / 5: msls-val best R@1 = 0.9027, current R@1 = 0.9000
2024-04-29 00:09:58   Start training epoch: 12
2024-04-29 00:29:58   Finished epoch 12 in 0:20:00, average epoch loss = 0.1848
2024-04-29 00:30:59   Ranking results: msls_val R@1: 0.8946, R@5: 0.9459, R@10: 0.9541, R@15: 0.9608, R@20: 0.9635, R@50: 0.9703, R@100: 0.9757
2024-04-29 00:31:02   Not improved: 4 / 5: msls-val best R@1 = 0.9027, current R@1 = 0.8946
2024-04-29 00:31:02   Start training epoch: 13
2024-04-29 00:51:04   Finished epoch 13 in 0:20:01, average epoch loss = 0.1827
2024-04-29 00:52:04   Ranking results: msls_val R@1: 0.8973, R@5: 0.9432, R@10: 0.9554, R@15: 0.9622, R@20: 0.9662, R@50: 0.9689, R@100: 0.9770
2024-04-29 00:52:08   Not improved: 5 / 5: msls-val best R@1 = 0.9027, current R@1 = 0.8973
2024-04-29 00:52:08   Performance did not improve for 5 epochs. Stop training.
2024-04-29 00:52:08   Best  msls-val best R@1 = 0.9027
2024-04-29 00:52:08   Trained for 14 epochs, in total in 4:55:18
2024-04-29 00:52:08   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-04-29 00:52:08   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-04-29 00:52:08   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-04-29 00:52:08   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-04-29 00:52:08   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-04-29 00:52:08   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-04-29 00:52:09   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-04-29 00:52:10   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-04-29 00:52:10   Test *best* model on test set
2024-04-29 00:53:11   Ranking results: msls_val R@1: 0.9027, R@5: 0.9473, R@10: 0.9595, R@15: 0.9662, R@20: 0.9662, R@50: 0.9743, R@100: 0.9770
2024-04-29 00:59:29   Ranking results: tokyo247 R@1: 0.8298, R@5: 0.9078, R@10: 0.9267, R@15: 0.9409, R@20: 0.9409, R@50: 0.9551, R@100: 0.9716
2024-04-29 00:59:35   Ranking results: SPED R@1: 0.8863, R@5: 0.9506, R@10: 0.9638, R@15: 0.9703, R@20: 0.9736, R@50: 0.9769, R@100: 0.9835
2024-04-29 01:01:14   Ranking results: nordland R@1: 0.5674, R@5: 0.7355, R@10: 0.7899, R@15: 0.8174, R@20: 0.8384, R@50: 0.8960, R@100: 0.9279
2024-04-29 01:02:18   Ranking results: pitts30k_val R@1: 0.9465, R@5: 0.9879, R@10: 0.9936, R@15: 0.9961, R@20: 0.9970, R@50: 0.9992, R@100: 0.9999
2024-04-29 01:03:19   Ranking results: pitts30k_test R@1: 0.9177, R@5: 0.9586, R@10: 0.9710, R@15: 0.9754, R@20: 0.9780, R@50: 0.9871, R@100: 0.9913
2024-04-29 01:09:26   Ranking results: pitts250k_test R@1: 0.9444, R@5: 0.9837, R@10: 0.9914, R@15: 0.9932, R@20: 0.9944, R@50: 0.9965, R@100: 0.9977
2024-04-29 01:14:59   Ranking results: pitts250k_val R@1: 0.9435, R@5: 0.9865, R@10: 0.9917, R@15: 0.9940, R@20: 0.9950, R@50: 0.9983, R@100: 0.9997
2024-04-29 01:14:59   Test *last* model on test set
2024-04-29 01:15:59   Ranking results: msls_val R@1: 0.8973, R@5: 0.9432, R@10: 0.9554, R@15: 0.9622, R@20: 0.9662, R@50: 0.9689, R@100: 0.9770
2024-04-29 01:22:17   Ranking results: tokyo247 R@1: 0.8345, R@5: 0.9007, R@10: 0.9220, R@15: 0.9314, R@20: 0.9385, R@50: 0.9574, R@100: 0.9622
2024-04-29 01:22:23   Ranking results: SPED R@1: 0.8913, R@5: 0.9456, R@10: 0.9621, R@15: 0.9638, R@20: 0.9671, R@50: 0.9753, R@100: 0.9852
2024-04-29 01:24:02   Ranking results: nordland R@1: 0.5514, R@5: 0.7192, R@10: 0.7775, R@15: 0.8058, R@20: 0.8236, R@50: 0.8790, R@100: 0.9163
2024-04-29 01:25:05   Ranking results: pitts30k_val R@1: 0.9452, R@5: 0.9879, R@10: 0.9938, R@15: 0.9959, R@20: 0.9967, R@50: 0.9996, R@100: 0.9999
2024-04-29 01:26:05   Ranking results: pitts30k_test R@1: 0.9167, R@5: 0.9563, R@10: 0.9680, R@15: 0.9721, R@20: 0.9748, R@50: 0.9853, R@100: 0.9905
2024-04-29 01:32:11   Ranking results: pitts250k_test R@1: 0.9460, R@5: 0.9825, R@10: 0.9906, R@15: 0.9924, R@20: 0.9937, R@50: 0.9963, R@100: 0.9973
2024-04-29 01:37:43   Ranking results: pitts250k_val R@1: 0.9426, R@5: 0.9867, R@10: 0.9921, R@15: 0.9940, R@20: 0.9954, R@50: 0.9987, R@100: 0.9996
