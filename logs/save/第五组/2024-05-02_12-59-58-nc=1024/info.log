2024-05-02 12:59:58   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=1024, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-02_12-59-58', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-02 12:59:58   The outputs are being saved in logs/2024-05-02_12-59-58
2024-05-02 12:59:58   validation dataset names:['msls_val']
2024-05-02 12:59:58   Using 2 GPUs and 64 CPUs
2024-05-02 12:59:58   using MLP layer as FFN
2024-05-02 13:00:03   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 13:00:03   Start training epoch: 00
2024-05-02 13:19:43   Finished epoch 00 in 0:19:39, average epoch loss = 0.7937
2024-05-02 13:20:39   Ranking results: msls_val R@1: 0.8351, R@5: 0.9216, R@10: 0.9351, R@15: 0.9459, R@20: 0.9486, R@50: 0.9608, R@100: 0.9662
2024-05-02 13:20:42   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8351
2024-05-02 13:20:42   Start training epoch: 01
2024-05-02 13:40:17   Finished epoch 01 in 0:19:35, average epoch loss = 0.4402
2024-05-02 13:41:13   Ranking results: msls_val R@1: 0.8770, R@5: 0.9311, R@10: 0.9459, R@15: 0.9486, R@20: 0.9541, R@50: 0.9622, R@100: 0.9662
2024-05-02 13:41:20   Improved: previous msls-val best R@1 = 0.8351, current R@1 = 0.8770
2024-05-02 13:41:20   Start training epoch: 02
2024-05-02 14:00:54   Finished epoch 02 in 0:19:33, average epoch loss = 0.3796
2024-05-02 14:01:50   Ranking results: msls_val R@1: 0.8635, R@5: 0.9297, R@10: 0.9500, R@15: 0.9554, R@20: 0.9581, R@50: 0.9649, R@100: 0.9703
2024-05-02 14:01:54   Not improved: 1 / 3: msls-val best R@1 = 0.8770, current R@1 = 0.8635
2024-05-02 14:01:54   Start training epoch: 03
2024-05-02 14:21:31   Finished epoch 03 in 0:19:36, average epoch loss = 0.3210
2024-05-02 14:22:27   Ranking results: msls_val R@1: 0.8730, R@5: 0.9351, R@10: 0.9473, R@15: 0.9595, R@20: 0.9635, R@50: 0.9689, R@100: 0.9730
2024-05-02 14:22:31   Not improved: 2 / 3: msls-val best R@1 = 0.8770, current R@1 = 0.8730
2024-05-02 14:22:31   Start training epoch: 04
2024-05-02 14:42:05   Finished epoch 04 in 0:19:33, average epoch loss = 0.2952
2024-05-02 14:43:01   Ranking results: msls_val R@1: 0.8851, R@5: 0.9405, R@10: 0.9500, R@15: 0.9554, R@20: 0.9595, R@50: 0.9689, R@100: 0.9757
2024-05-02 14:43:08   Improved: previous msls-val best R@1 = 0.8770, current R@1 = 0.8851
2024-05-02 14:43:08   Start training epoch: 05
2024-05-02 15:02:43   Finished epoch 05 in 0:19:34, average epoch loss = 0.2794
2024-05-02 15:03:38   Ranking results: msls_val R@1: 0.8730, R@5: 0.9378, R@10: 0.9473, R@15: 0.9568, R@20: 0.9595, R@50: 0.9716, R@100: 0.9757
2024-05-02 15:03:42   Not improved: 1 / 3: msls-val best R@1 = 0.8851, current R@1 = 0.8730
2024-05-02 15:03:42   Start training epoch: 06
2024-05-02 15:23:17   Finished epoch 06 in 0:19:35, average epoch loss = 0.2536
2024-05-02 15:24:14   Ranking results: msls_val R@1: 0.8851, R@5: 0.9365, R@10: 0.9486, R@15: 0.9554, R@20: 0.9568, R@50: 0.9649, R@100: 0.9743
2024-05-02 15:24:17   Not improved: 2 / 3: msls-val best R@1 = 0.8851, current R@1 = 0.8851
2024-05-02 15:24:17   Start training epoch: 07
2024-05-02 15:43:52   Finished epoch 07 in 0:19:35, average epoch loss = 0.2388
2024-05-02 15:44:48   Ranking results: msls_val R@1: 0.8824, R@5: 0.9473, R@10: 0.9554, R@15: 0.9608, R@20: 0.9635, R@50: 0.9730, R@100: 0.9784
2024-05-02 15:44:51   Not improved: 3 / 3: msls-val best R@1 = 0.8851, current R@1 = 0.8824
2024-05-02 15:44:51   Performance did not improve for 3 epochs. Stop training.
2024-05-02 15:44:51   Best  msls-val best R@1 = 0.8851
2024-05-02 15:44:51   Trained for 08 epochs, in total in 2:44:53
2024-05-02 15:44:51   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 15:44:51   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-02 15:44:51   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-02 15:44:51   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-02 15:44:51   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-02 15:44:52   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-02 15:44:52   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-02 15:44:53   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-02 15:44:53   Test *best* model on test set
2024-05-02 15:45:50   Ranking results: msls_val R@1: 0.8851, R@5: 0.9405, R@10: 0.9500, R@15: 0.9554, R@20: 0.9595, R@50: 0.9689, R@100: 0.9757
2024-05-02 15:52:07   Ranking results: tokyo247 R@1: 0.8227, R@5: 0.8865, R@10: 0.9149, R@15: 0.9314, R@20: 0.9385, R@50: 0.9504, R@100: 0.9598
2024-05-02 15:52:12   Ranking results: SPED R@1: 0.8699, R@5: 0.9374, R@10: 0.9473, R@15: 0.9539, R@20: 0.9588, R@50: 0.9736, R@100: 0.9852
2024-05-02 15:53:40   Ranking results: nordland R@1: 0.5344, R@5: 0.7203, R@10: 0.7728, R@15: 0.8033, R@20: 0.8261, R@50: 0.8837, R@100: 0.9178
2024-05-02 15:54:34   Ranking results: pitts30k_val R@1: 0.9384, R@5: 0.9890, R@10: 0.9933, R@15: 0.9957, R@20: 0.9965, R@50: 0.9979, R@100: 0.9989
2024-05-02 15:55:24   Ranking results: pitts30k_test R@1: 0.9079, R@5: 0.9503, R@10: 0.9621, R@15: 0.9693, R@20: 0.9742, R@50: 0.9871, R@100: 0.9919
2024-05-02 16:00:00   Ranking results: pitts250k_test R@1: 0.9360, R@5: 0.9755, R@10: 0.9836, R@15: 0.9872, R@20: 0.9897, R@50: 0.9949, R@100: 0.9965
2024-05-02 16:04:16   Ranking results: pitts250k_val R@1: 0.9361, R@5: 0.9854, R@10: 0.9919, R@15: 0.9942, R@20: 0.9954, R@50: 0.9974, R@100: 0.9984
2024-05-02 16:04:16   Test *last* model on test set
2024-05-02 16:05:13   Ranking results: msls_val R@1: 0.8824, R@5: 0.9473, R@10: 0.9554, R@15: 0.9608, R@20: 0.9635, R@50: 0.9730, R@100: 0.9784
2024-05-02 16:11:29   Ranking results: tokyo247 R@1: 0.8085, R@5: 0.9007, R@10: 0.9220, R@15: 0.9362, R@20: 0.9385, R@50: 0.9574, R@100: 0.9716
2024-05-02 16:11:35   Ranking results: SPED R@1: 0.8715, R@5: 0.9390, R@10: 0.9489, R@15: 0.9555, R@20: 0.9605, R@50: 0.9736, R@100: 0.9802
2024-05-02 16:13:02   Ranking results: nordland R@1: 0.5123, R@5: 0.6942, R@10: 0.7558, R@15: 0.7895, R@20: 0.8178, R@50: 0.8822, R@100: 0.9192
2024-05-02 16:13:56   Ranking results: pitts30k_val R@1: 0.9449, R@5: 0.9894, R@10: 0.9949, R@15: 0.9970, R@20: 0.9974, R@50: 0.9991, R@100: 0.9997
2024-05-02 16:14:47   Ranking results: pitts30k_test R@1: 0.9092, R@5: 0.9531, R@10: 0.9673, R@15: 0.9730, R@20: 0.9764, R@50: 0.9877, R@100: 0.9912
2024-05-02 16:19:23   Ranking results: pitts250k_test R@1: 0.9372, R@5: 0.9774, R@10: 0.9874, R@15: 0.9902, R@20: 0.9926, R@50: 0.9965, R@100: 0.9979
2024-05-02 16:23:40   Ranking results: pitts250k_val R@1: 0.9399, R@5: 0.9857, R@10: 0.9922, R@15: 0.9950, R@20: 0.9961, R@50: 0.9980, R@100: 0.9996
