2024-05-02 12:57:32   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=512, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-02_12-57-32', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-02 12:57:32   The outputs are being saved in logs/2024-05-02_12-57-32
2024-05-02 12:57:32   validation dataset names:['msls_val']
2024-05-02 12:57:33   Using 2 GPUs and 64 CPUs
2024-05-02 12:57:33   using MLP layer as FFN
2024-05-02 12:57:37   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 12:57:37   Start training epoch: 00
2024-05-02 13:17:36   Finished epoch 00 in 0:19:58, average epoch loss = 0.7701
2024-05-02 13:18:34   Ranking results: msls_val R@1: 0.8419, R@5: 0.9189, R@10: 0.9392, R@15: 0.9500, R@20: 0.9527, R@50: 0.9649, R@100: 0.9703
2024-05-02 13:18:37   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8419
2024-05-02 13:18:37   Start training epoch: 01
2024-05-02 13:38:33   Finished epoch 01 in 0:19:56, average epoch loss = 0.4460
2024-05-02 13:39:31   Ranking results: msls_val R@1: 0.8595, R@5: 0.9257, R@10: 0.9419, R@15: 0.9500, R@20: 0.9581, R@50: 0.9635, R@100: 0.9676
2024-05-02 13:39:38   Improved: previous msls-val best R@1 = 0.8419, current R@1 = 0.8595
2024-05-02 13:39:38   Start training epoch: 02
2024-05-02 13:59:34   Finished epoch 02 in 0:19:55, average epoch loss = 0.3802
2024-05-02 14:00:32   Ranking results: msls_val R@1: 0.8514, R@5: 0.9284, R@10: 0.9446, R@15: 0.9500, R@20: 0.9568, R@50: 0.9649, R@100: 0.9689
2024-05-02 14:00:35   Not improved: 1 / 3: msls-val best R@1 = 0.8595, current R@1 = 0.8514
2024-05-02 14:00:35   Start training epoch: 03
2024-05-02 14:20:30   Finished epoch 03 in 0:19:54, average epoch loss = 0.3207
2024-05-02 14:21:27   Ranking results: msls_val R@1: 0.8595, R@5: 0.9324, R@10: 0.9446, R@15: 0.9514, R@20: 0.9581, R@50: 0.9689, R@100: 0.9743
2024-05-02 14:21:31   Not improved: 2 / 3: msls-val best R@1 = 0.8595, current R@1 = 0.8595
2024-05-02 14:21:31   Start training epoch: 04
2024-05-02 14:41:25   Finished epoch 04 in 0:19:54, average epoch loss = 0.2908
2024-05-02 14:42:23   Ranking results: msls_val R@1: 0.8635, R@5: 0.9270, R@10: 0.9405, R@15: 0.9500, R@20: 0.9554, R@50: 0.9676, R@100: 0.9730
2024-05-02 14:42:30   Improved: previous msls-val best R@1 = 0.8595, current R@1 = 0.8635
2024-05-02 14:42:30   Start training epoch: 05
2024-05-02 15:02:23   Finished epoch 05 in 0:19:53, average epoch loss = 0.2722
2024-05-02 15:03:21   Ranking results: msls_val R@1: 0.8622, R@5: 0.9351, R@10: 0.9473, R@15: 0.9514, R@20: 0.9581, R@50: 0.9662, R@100: 0.9757
2024-05-02 15:03:24   Not improved: 1 / 3: msls-val best R@1 = 0.8635, current R@1 = 0.8622
2024-05-02 15:03:24   Start training epoch: 06
2024-05-02 15:23:18   Finished epoch 06 in 0:19:53, average epoch loss = 0.2447
2024-05-02 15:24:16   Ranking results: msls_val R@1: 0.8541, R@5: 0.9297, R@10: 0.9405, R@15: 0.9527, R@20: 0.9554, R@50: 0.9703, R@100: 0.9730
2024-05-02 15:24:19   Not improved: 2 / 3: msls-val best R@1 = 0.8635, current R@1 = 0.8541
2024-05-02 15:24:19   Start training epoch: 07
2024-05-02 15:44:16   Finished epoch 07 in 0:19:56, average epoch loss = 0.2276
2024-05-02 15:45:14   Ranking results: msls_val R@1: 0.8635, R@5: 0.9297, R@10: 0.9446, R@15: 0.9527, R@20: 0.9541, R@50: 0.9676, R@100: 0.9703
2024-05-02 15:45:17   Not improved: 3 / 3: msls-val best R@1 = 0.8635, current R@1 = 0.8635
2024-05-02 15:45:17   Performance did not improve for 3 epochs. Stop training.
2024-05-02 15:45:17   Best  msls-val best R@1 = 0.8635
2024-05-02 15:45:17   Trained for 08 epochs, in total in 2:47:44
2024-05-02 15:45:17   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 15:45:17   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-02 15:45:17   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-02 15:45:17   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-02 15:45:18   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-02 15:45:18   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-02 15:45:18   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-02 15:45:19   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-02 15:45:19   Test *best* model on test set
2024-05-02 15:46:17   Ranking results: msls_val R@1: 0.8635, R@5: 0.9270, R@10: 0.9405, R@15: 0.9500, R@20: 0.9554, R@50: 0.9676, R@100: 0.9730
2024-05-02 15:52:25   Ranking results: tokyo247 R@1: 0.8085, R@5: 0.8747, R@10: 0.9054, R@15: 0.9196, R@20: 0.9243, R@50: 0.9574, R@100: 0.9669
2024-05-02 15:52:31   Ranking results: SPED R@1: 0.8484, R@5: 0.9292, R@10: 0.9440, R@15: 0.9539, R@20: 0.9605, R@50: 0.9703, R@100: 0.9835
2024-05-02 15:53:59   Ranking results: nordland R@1: 0.4754, R@5: 0.6681, R@10: 0.7377, R@15: 0.7717, R@20: 0.7960, R@50: 0.8641, R@100: 0.9130
2024-05-02 15:54:53   Ranking results: pitts30k_val R@1: 0.9373, R@5: 0.9854, R@10: 0.9915, R@15: 0.9945, R@20: 0.9958, R@50: 0.9987, R@100: 0.9996
2024-05-02 15:55:45   Ranking results: pitts30k_test R@1: 0.9058, R@5: 0.9558, R@10: 0.9680, R@15: 0.9733, R@20: 0.9768, R@50: 0.9846, R@100: 0.9903
2024-05-02 16:00:20   Ranking results: pitts250k_test R@1: 0.9348, R@5: 0.9789, R@10: 0.9874, R@15: 0.9907, R@20: 0.9924, R@50: 0.9959, R@100: 0.9967
2024-05-02 16:04:37   Ranking results: pitts250k_val R@1: 0.9349, R@5: 0.9833, R@10: 0.9895, R@15: 0.9929, R@20: 0.9938, R@50: 0.9974, R@100: 0.9988
2024-05-02 16:04:37   Test *last* model on test set
2024-05-02 16:05:36   Ranking results: msls_val R@1: 0.8635, R@5: 0.9297, R@10: 0.9446, R@15: 0.9527, R@20: 0.9541, R@50: 0.9676, R@100: 0.9703
2024-05-02 16:11:55   Ranking results: tokyo247 R@1: 0.8085, R@5: 0.8818, R@10: 0.8960, R@15: 0.9054, R@20: 0.9149, R@50: 0.9362, R@100: 0.9574
2024-05-02 16:12:00   Ranking results: SPED R@1: 0.8666, R@5: 0.9390, R@10: 0.9588, R@15: 0.9638, R@20: 0.9736, R@50: 0.9786, R@100: 0.9852
2024-05-02 16:13:29   Ranking results: nordland R@1: 0.4380, R@5: 0.6127, R@10: 0.6768, R@15: 0.7087, R@20: 0.7304, R@50: 0.8156, R@100: 0.8728
2024-05-02 16:14:23   Ranking results: pitts30k_val R@1: 0.9373, R@5: 0.9841, R@10: 0.9925, R@15: 0.9947, R@20: 0.9961, R@50: 0.9975, R@100: 0.9992
2024-05-02 16:15:15   Ranking results: pitts30k_test R@1: 0.9115, R@5: 0.9579, R@10: 0.9698, R@15: 0.9761, R@20: 0.9803, R@50: 0.9868, R@100: 0.9912
2024-05-02 16:19:51   Ranking results: pitts250k_test R@1: 0.9393, R@5: 0.9830, R@10: 0.9891, R@15: 0.9920, R@20: 0.9941, R@50: 0.9964, R@100: 0.9976
2024-05-02 16:24:07   Ranking results: pitts250k_val R@1: 0.9355, R@5: 0.9826, R@10: 0.9907, R@15: 0.9933, R@20: 0.9946, R@50: 0.9970, R@100: 0.9982
