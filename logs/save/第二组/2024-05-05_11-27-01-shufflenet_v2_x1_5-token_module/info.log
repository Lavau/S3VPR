2024-05-05 11:27:01   Arguments: Namespace(aggregator_name='token_module', backbone_name='shufflenet_v2_x1_5', device='cuda', dim=1024, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-05_11-27-01-shufflenet_v2_x1_5-token_module', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-05 11:27:01   The outputs are being saved in logs/2024-05-05_11-27-01-shufflenet_v2_x1_5-token_module
2024-05-05 11:27:01   validation dataset names:['msls_val']
2024-05-05 11:27:01   Using 2 GPUs and 64 CPUs
2024-05-05 11:27:04   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-05 11:27:04   Start training epoch: 00
2024-05-05 11:36:50   Finished epoch 00 in 0:09:45, average epoch loss = 1.4581
2024-05-05 11:37:21   Ranking results: msls_val R@1: 0.3500, R@5: 0.4946, R@10: 0.5500, R@15: 0.5905, R@20: 0.6189, R@50: 0.6986, R@100: 0.7581
2024-05-05 11:37:22   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.3500
2024-05-05 11:37:22   Start training epoch: 01
2024-05-05 11:47:10   Finished epoch 01 in 0:09:48, average epoch loss = 1.3383
2024-05-05 11:47:42   Ranking results: msls_val R@1: 0.3986, R@5: 0.5608, R@10: 0.6162, R@15: 0.6486, R@20: 0.6689, R@50: 0.7554, R@100: 0.8000
2024-05-05 11:47:42   Improved: previous msls-val best R@1 = 0.3500, current R@1 = 0.3986
2024-05-05 11:47:42   Start training epoch: 02
2024-05-05 11:57:25   Finished epoch 02 in 0:09:42, average epoch loss = 1.2877
2024-05-05 11:57:57   Ranking results: msls_val R@1: 0.4135, R@5: 0.5595, R@10: 0.6135, R@15: 0.6554, R@20: 0.6716, R@50: 0.7392, R@100: 0.7878
2024-05-05 11:57:57   Improved: previous msls-val best R@1 = 0.3986, current R@1 = 0.4135
2024-05-05 11:57:57   Start training epoch: 03
2024-05-05 12:07:46   Finished epoch 03 in 0:09:48, average epoch loss = 1.2668
2024-05-05 12:08:19   Ranking results: msls_val R@1: 0.4216, R@5: 0.5527, R@10: 0.6257, R@15: 0.6662, R@20: 0.6932, R@50: 0.7473, R@100: 0.7959
2024-05-05 12:08:20   Improved: previous msls-val best R@1 = 0.4135, current R@1 = 0.4216
2024-05-05 12:08:20   Start training epoch: 04
2024-05-05 12:18:11   Finished epoch 04 in 0:09:51, average epoch loss = 1.2466
2024-05-05 12:18:43   Ranking results: msls_val R@1: 0.4324, R@5: 0.5838, R@10: 0.6324, R@15: 0.6622, R@20: 0.6892, R@50: 0.7392, R@100: 0.7919
2024-05-05 12:18:44   Improved: previous msls-val best R@1 = 0.4216, current R@1 = 0.4324
2024-05-05 12:18:44   Start training epoch: 05
2024-05-05 12:28:33   Finished epoch 05 in 0:09:49, average epoch loss = 1.2243
2024-05-05 12:29:07   Ranking results: msls_val R@1: 0.4473, R@5: 0.5851, R@10: 0.6419, R@15: 0.6743, R@20: 0.6919, R@50: 0.7568, R@100: 0.8027
2024-05-05 12:29:08   Improved: previous msls-val best R@1 = 0.4324, current R@1 = 0.4473
2024-05-05 12:29:08   Start training epoch: 06
2024-05-05 12:38:39   Finished epoch 06 in 0:09:31, average epoch loss = 1.2031
2024-05-05 12:39:10   Ranking results: msls_val R@1: 0.4459, R@5: 0.5878, R@10: 0.6365, R@15: 0.6595, R@20: 0.6905, R@50: 0.7568, R@100: 0.7973
2024-05-05 12:39:10   Not improved: 1 / 3: msls-val best R@1 = 0.4473, current R@1 = 0.4459
2024-05-05 12:39:10   Start training epoch: 07
2024-05-05 12:49:02   Finished epoch 07 in 0:09:51, average epoch loss = 1.1918
2024-05-05 12:49:35   Ranking results: msls_val R@1: 0.4568, R@5: 0.6027, R@10: 0.6473, R@15: 0.6811, R@20: 0.6946, R@50: 0.7581, R@100: 0.8068
2024-05-05 12:49:36   Improved: previous msls-val best R@1 = 0.4473, current R@1 = 0.4568
2024-05-05 12:49:36   Start training epoch: 08
2024-05-05 12:59:13   Finished epoch 08 in 0:09:37, average epoch loss = 1.1834
2024-05-05 12:59:44   Ranking results: msls_val R@1: 0.4635, R@5: 0.6014, R@10: 0.6541, R@15: 0.6824, R@20: 0.7095, R@50: 0.7622, R@100: 0.8000
2024-05-05 12:59:45   Improved: previous msls-val best R@1 = 0.4568, current R@1 = 0.4635
2024-05-05 12:59:45   Start training epoch: 09
2024-05-05 13:09:19   Finished epoch 09 in 0:09:34, average epoch loss = 1.1758
2024-05-05 13:09:50   Ranking results: msls_val R@1: 0.4608, R@5: 0.6068, R@10: 0.6486, R@15: 0.6757, R@20: 0.7081, R@50: 0.7622, R@100: 0.8041
2024-05-05 13:09:51   Not improved: 1 / 3: msls-val best R@1 = 0.4635, current R@1 = 0.4608
2024-05-05 13:09:51   Start training epoch: 10
2024-05-05 13:19:25   Finished epoch 10 in 0:09:34, average epoch loss = 1.1679
2024-05-05 13:19:56   Ranking results: msls_val R@1: 0.4649, R@5: 0.6000, R@10: 0.6608, R@15: 0.6932, R@20: 0.7068, R@50: 0.7662, R@100: 0.8027
2024-05-05 13:19:56   Improved: previous msls-val best R@1 = 0.4635, current R@1 = 0.4649
2024-05-05 13:19:56   Start training epoch: 11
2024-05-05 13:29:31   Finished epoch 11 in 0:09:34, average epoch loss = 1.1629
2024-05-05 13:30:02   Ranking results: msls_val R@1: 0.4595, R@5: 0.5986, R@10: 0.6500, R@15: 0.6797, R@20: 0.7041, R@50: 0.7595, R@100: 0.7973
2024-05-05 13:30:02   Not improved: 1 / 3: msls-val best R@1 = 0.4649, current R@1 = 0.4595
2024-05-05 13:30:02   Start training epoch: 12
2024-05-05 13:39:40   Finished epoch 12 in 0:09:37, average epoch loss = 1.1605
2024-05-05 13:40:11   Ranking results: msls_val R@1: 0.4649, R@5: 0.6014, R@10: 0.6527, R@15: 0.6905, R@20: 0.7135, R@50: 0.7662, R@100: 0.8014
2024-05-05 13:40:11   Not improved: 2 / 3: msls-val best R@1 = 0.4649, current R@1 = 0.4649
2024-05-05 13:40:11   Start training epoch: 13
2024-05-05 13:49:49   Finished epoch 13 in 0:09:37, average epoch loss = 1.1561
2024-05-05 13:50:22   Ranking results: msls_val R@1: 0.4608, R@5: 0.6000, R@10: 0.6554, R@15: 0.6892, R@20: 0.7054, R@50: 0.7608, R@100: 0.8027
2024-05-05 13:50:22   Not improved: 3 / 3: msls-val best R@1 = 0.4649, current R@1 = 0.4608
2024-05-05 13:50:22   Performance did not improve for 3 epochs. Stop training.
2024-05-05 13:50:22   Best  msls-val best R@1 = 0.4649
2024-05-05 13:50:22   Trained for 14 epochs, in total in 2:23:20
2024-05-05 13:50:22   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-05 13:50:22   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-05 13:50:22   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-05 13:50:22   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-05 13:50:22   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-05 13:50:22   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-05 13:50:23   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-05 13:50:24   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-05 13:50:24   Test *best* model on test set
2024-05-05 13:50:55   Ranking results: msls_val R@1: 0.4649, R@5: 0.6000, R@10: 0.6608, R@15: 0.6932, R@20: 0.7068, R@50: 0.7662, R@100: 0.8027
2024-05-05 13:57:14   Ranking results: tokyo247 R@1: 0.2270, R@5: 0.3735, R@10: 0.4208, R@15: 0.4563, R@20: 0.4752, R@50: 0.5579, R@100: 0.6147
2024-05-05 13:57:17   Ranking results: SPED R@1: 0.4217, R@5: 0.5914, R@10: 0.6573, R@15: 0.7051, R@20: 0.7348, R@50: 0.8517, R@100: 0.9044
2024-05-05 13:58:07   Ranking results: nordland R@1: 0.0264, R@5: 0.0471, R@10: 0.0598, R@15: 0.0717, R@20: 0.0812, R@50: 0.1163, R@100: 0.1609
2024-05-05 13:58:44   Ranking results: pitts30k_val R@1: 0.6978, R@5: 0.8625, R@10: 0.9088, R@15: 0.9322, R@20: 0.9445, R@50: 0.9761, R@100: 0.9890
2024-05-05 13:59:19   Ranking results: pitts30k_test R@1: 0.6997, R@5: 0.8490, R@10: 0.8894, R@15: 0.9096, R@20: 0.9218, R@50: 0.9572, R@100: 0.9711
2024-05-05 14:03:03   Ranking results: pitts250k_test R@1: 0.6106, R@5: 0.7557, R@10: 0.7967, R@15: 0.8217, R@20: 0.8380, R@50: 0.8822, R@100: 0.9105
2024-05-05 14:06:25   Ranking results: pitts250k_val R@1: 0.5921, R@5: 0.7149, R@10: 0.7563, R@15: 0.7779, R@20: 0.7959, R@50: 0.8402, R@100: 0.8739
2024-05-05 14:06:25   Test *last* model on test set
2024-05-05 14:06:56   Ranking results: msls_val R@1: 0.4608, R@5: 0.6000, R@10: 0.6554, R@15: 0.6892, R@20: 0.7054, R@50: 0.7608, R@100: 0.8027
2024-05-05 14:13:14   Ranking results: tokyo247 R@1: 0.2482, R@5: 0.3712, R@10: 0.4279, R@15: 0.4468, R@20: 0.4704, R@50: 0.5556, R@100: 0.6194
2024-05-05 14:13:16   Ranking results: SPED R@1: 0.4152, R@5: 0.5848, R@10: 0.6557, R@15: 0.6985, R@20: 0.7282, R@50: 0.8402, R@100: 0.9012
2024-05-05 14:14:06   Ranking results: nordland R@1: 0.0297, R@5: 0.0482, R@10: 0.0630, R@15: 0.0736, R@20: 0.0819, R@50: 0.1196, R@100: 0.1601
2024-05-05 14:14:42   Ranking results: pitts30k_val R@1: 0.6993, R@5: 0.8592, R@10: 0.9064, R@15: 0.9272, R@20: 0.9415, R@50: 0.9742, R@100: 0.9880
2024-05-05 14:15:17   Ranking results: pitts30k_test R@1: 0.6945, R@5: 0.8455, R@10: 0.8848, R@15: 0.9070, R@20: 0.9190, R@50: 0.9510, R@100: 0.9676
2024-05-05 14:19:02   Ranking results: pitts250k_test R@1: 0.5925, R@5: 0.7402, R@10: 0.7841, R@15: 0.8037, R@20: 0.8203, R@50: 0.8665, R@100: 0.8979
2024-05-05 14:22:27   Ranking results: pitts250k_val R@1: 0.5769, R@5: 0.6930, R@10: 0.7307, R@15: 0.7543, R@20: 0.7695, R@50: 0.8193, R@100: 0.8545
