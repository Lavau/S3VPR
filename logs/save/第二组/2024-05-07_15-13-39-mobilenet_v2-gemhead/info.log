2024-05-07 15:13:39   Arguments: Namespace(aggregator_name='gemhead', backbone_name='mobilenet_v2', device='cuda', dim=1280, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-07_15-13-39-mobilenet_v2-gemhead', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-07 15:13:39   The outputs are being saved in logs/2024-05-07_15-13-39-mobilenet_v2-gemhead
2024-05-07 15:13:39   validation dataset names:['msls_val']
2024-05-07 15:13:39   Using 2 GPUs and 64 CPUs
2024-05-07 15:13:42   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-07 15:13:42   Start training epoch: 00
2024-05-07 15:23:07   Finished epoch 00 in 0:09:24, average epoch loss = 1.0879
2024-05-07 15:23:37   Ranking results: msls_val R@1: 0.6527, R@5: 0.7581, R@10: 0.7959, R@15: 0.8230, R@20: 0.8405, R@50: 0.8730, R@100: 0.8973
2024-05-07 15:23:37   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.6527
2024-05-07 15:23:37   Start training epoch: 01
2024-05-07 15:32:36   Finished epoch 01 in 0:08:58, average epoch loss = 0.8594
2024-05-07 15:33:06   Ranking results: msls_val R@1: 0.6892, R@5: 0.7932, R@10: 0.8189, R@15: 0.8351, R@20: 0.8459, R@50: 0.8757, R@100: 0.9027
2024-05-07 15:33:07   Improved: previous msls-val best R@1 = 0.6527, current R@1 = 0.6892
2024-05-07 15:33:07   Start training epoch: 02
2024-05-07 15:42:12   Finished epoch 02 in 0:09:05, average epoch loss = 0.7709
2024-05-07 15:42:42   Ranking results: msls_val R@1: 0.6959, R@5: 0.7932, R@10: 0.8230, R@15: 0.8473, R@20: 0.8595, R@50: 0.8838, R@100: 0.8959
2024-05-07 15:42:42   Improved: previous msls-val best R@1 = 0.6892, current R@1 = 0.6959
2024-05-07 15:42:42   Start training epoch: 03
2024-05-07 15:51:42   Finished epoch 03 in 0:08:59, average epoch loss = 0.7121
2024-05-07 15:52:11   Ranking results: msls_val R@1: 0.7122, R@5: 0.7973, R@10: 0.8351, R@15: 0.8514, R@20: 0.8608, R@50: 0.8811, R@100: 0.9027
2024-05-07 15:52:12   Improved: previous msls-val best R@1 = 0.6959, current R@1 = 0.7122
2024-05-07 15:52:12   Start training epoch: 04
2024-05-07 16:00:59   Finished epoch 04 in 0:08:46, average epoch loss = 0.6836
2024-05-07 16:01:28   Ranking results: msls_val R@1: 0.7000, R@5: 0.8014, R@10: 0.8324, R@15: 0.8514, R@20: 0.8635, R@50: 0.8851, R@100: 0.9054
2024-05-07 16:01:28   Not improved: 1 / 3: msls-val best R@1 = 0.7122, current R@1 = 0.7000
2024-05-07 16:01:28   Start training epoch: 05
2024-05-07 16:10:19   Finished epoch 05 in 0:08:50, average epoch loss = 0.6599
2024-05-07 16:10:48   Ranking results: msls_val R@1: 0.7149, R@5: 0.8068, R@10: 0.8338, R@15: 0.8541, R@20: 0.8649, R@50: 0.8905, R@100: 0.9027
2024-05-07 16:10:48   Improved: previous msls-val best R@1 = 0.7122, current R@1 = 0.7149
2024-05-07 16:10:48   Start training epoch: 06
2024-05-07 16:19:35   Finished epoch 06 in 0:08:47, average epoch loss = 0.6398
2024-05-07 16:20:05   Ranking results: msls_val R@1: 0.7162, R@5: 0.8041, R@10: 0.8311, R@15: 0.8554, R@20: 0.8622, R@50: 0.8892, R@100: 0.9081
2024-05-07 16:20:06   Improved: previous msls-val best R@1 = 0.7149, current R@1 = 0.7162
2024-05-07 16:20:06   Start training epoch: 07
2024-05-07 16:28:55   Finished epoch 07 in 0:08:49, average epoch loss = 0.6276
2024-05-07 16:29:24   Ranking results: msls_val R@1: 0.7230, R@5: 0.8027, R@10: 0.8351, R@15: 0.8514, R@20: 0.8608, R@50: 0.8878, R@100: 0.9081
2024-05-07 16:29:24   Improved: previous msls-val best R@1 = 0.7162, current R@1 = 0.7230
2024-05-07 16:29:24   Start training epoch: 08
2024-05-07 16:38:10   Finished epoch 08 in 0:08:46, average epoch loss = 0.6177
2024-05-07 16:38:40   Ranking results: msls_val R@1: 0.7189, R@5: 0.8000, R@10: 0.8338, R@15: 0.8527, R@20: 0.8608, R@50: 0.8905, R@100: 0.9122
2024-05-07 16:38:41   Not improved: 1 / 3: msls-val best R@1 = 0.7230, current R@1 = 0.7189
2024-05-07 16:38:41   Start training epoch: 09
2024-05-07 16:47:24   Finished epoch 09 in 0:08:43, average epoch loss = 0.6067
2024-05-07 16:47:54   Ranking results: msls_val R@1: 0.7189, R@5: 0.8095, R@10: 0.8446, R@15: 0.8554, R@20: 0.8662, R@50: 0.8919, R@100: 0.9122
2024-05-07 16:47:54   Not improved: 2 / 3: msls-val best R@1 = 0.7230, current R@1 = 0.7189
2024-05-07 16:47:54   Start training epoch: 10
2024-05-07 16:56:43   Finished epoch 10 in 0:08:48, average epoch loss = 0.6007
2024-05-07 16:57:13   Ranking results: msls_val R@1: 0.7216, R@5: 0.8176, R@10: 0.8392, R@15: 0.8581, R@20: 0.8662, R@50: 0.8892, R@100: 0.9162
2024-05-07 16:57:13   Not improved: 3 / 3: msls-val best R@1 = 0.7230, current R@1 = 0.7216
2024-05-07 16:57:13   Performance did not improve for 3 epochs. Stop training.
2024-05-07 16:57:13   Best  msls-val best R@1 = 0.7230
2024-05-07 16:57:13   Trained for 11 epochs, in total in 1:43:34
2024-05-07 16:57:13   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-07 16:57:13   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-07 16:57:13   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-07 16:57:14   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-07 16:57:14   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-07 16:57:14   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-07 16:57:14   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-07 16:57:15   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-07 16:57:15   Test *best* model on test set
2024-05-07 16:57:45   Ranking results: msls_val R@1: 0.7230, R@5: 0.8027, R@10: 0.8351, R@15: 0.8514, R@20: 0.8608, R@50: 0.8878, R@100: 0.9081
2024-05-07 17:03:54   Ranking results: tokyo247 R@1: 0.1040, R@5: 0.1418, R@10: 0.1608, R@15: 0.1702, R@20: 0.1749, R@50: 0.1939, R@100: 0.1986
2024-05-07 17:03:57   Ranking results: SPED R@1: 0.6178, R@5: 0.7595, R@10: 0.8040, R@15: 0.8254, R@20: 0.8484, R@50: 0.9127, R@100: 0.9325
2024-05-07 17:04:45   Ranking results: nordland R@1: 0.1351, R@5: 0.2290, R@10: 0.2764, R@15: 0.3094, R@20: 0.3279, R@50: 0.4156, R@100: 0.4917
2024-05-07 17:05:21   Ranking results: pitts30k_val R@1: 0.6660, R@5: 0.7191, R@10: 0.7535, R@15: 0.7831, R@20: 0.8115, R@50: 0.9079, R@100: 0.9758
2024-05-07 17:05:55   Ranking results: pitts30k_test R@1: 0.6761, R@5: 0.7412, R@10: 0.8015, R@15: 0.8327, R@20: 0.8515, R@50: 0.8929, R@100: 0.9286
2024-05-07 17:09:26   Ranking results: pitts250k_test R@1: 0.6447, R@5: 0.6926, R@10: 0.7066, R@15: 0.7139, R@20: 0.7197, R@50: 0.7361, R@100: 0.7510
2024-05-07 17:12:40   Ranking results: pitts250k_val R@1: 0.5998, R@5: 0.6341, R@10: 0.6472, R@15: 0.6540, R@20: 0.6604, R@50: 0.6857, R@100: 0.7111
2024-05-07 17:12:40   Test *last* model on test set
2024-05-07 17:13:10   Ranking results: msls_val R@1: 0.7216, R@5: 0.8176, R@10: 0.8392, R@15: 0.8581, R@20: 0.8662, R@50: 0.8892, R@100: 0.9162
2024-05-07 17:19:15   Ranking results: tokyo247 R@1: 0.1087, R@5: 0.1560, R@10: 0.1631, R@15: 0.1726, R@20: 0.1773, R@50: 0.2175, R@100: 0.2293
2024-05-07 17:19:18   Ranking results: SPED R@1: 0.6244, R@5: 0.7512, R@10: 0.8040, R@15: 0.8353, R@20: 0.8517, R@50: 0.9127, R@100: 0.9374
2024-05-07 17:20:06   Ranking results: nordland R@1: 0.1402, R@5: 0.2366, R@10: 0.2859, R@15: 0.3210, R@20: 0.3489, R@50: 0.4391, R@100: 0.5120
2024-05-07 17:20:43   Ranking results: pitts30k_val R@1: 0.6755, R@5: 0.7388, R@10: 0.7658, R@15: 0.7879, R@20: 0.8055, R@50: 0.9230, R@100: 0.9763
2024-05-07 17:21:16   Ranking results: pitts30k_test R@1: 0.6860, R@5: 0.7484, R@10: 0.8121, R@15: 0.8439, R@20: 0.8597, R@50: 0.9010, R@100: 0.9327
2024-05-07 17:24:47   Ranking results: pitts250k_test R@1: 0.6443, R@5: 0.6885, R@10: 0.7018, R@15: 0.7092, R@20: 0.7147, R@50: 0.7302, R@100: 0.7435
2024-05-07 17:27:59   Ranking results: pitts250k_val R@1: 0.6009, R@5: 0.6400, R@10: 0.6525, R@15: 0.6618, R@20: 0.6686, R@50: 0.6941, R@100: 0.7256
