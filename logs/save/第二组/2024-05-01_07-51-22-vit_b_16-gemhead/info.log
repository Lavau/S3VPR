2024-05-01 07:51:22   Arguments: Namespace(aggregator_name='gemhead', backbone_name='vit_b_16', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=1, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-01_07-51-22', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-01 07:51:22   The outputs are being saved in logs/2024-05-01_07-51-22
2024-05-01 07:51:22   validation dataset names:['msls_val']
2024-05-01 07:51:22   Using 2 GPUs and 64 CPUs
2024-05-01 07:51:28   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 07:51:28   Start training epoch: 00
2024-05-01 08:20:37   Finished epoch 00 in 0:29:09, average epoch loss = 1.1157
2024-05-01 08:22:00   Ranking results: msls_val R@1: 0.5000, R@5: 0.6446, R@10: 0.6905, R@15: 0.7176, R@20: 0.7338, R@50: 0.8068, R@100: 0.8446
2024-05-01 08:22:03   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.5000
2024-05-01 08:22:03   Start training epoch: 01
2024-05-01 08:50:43   Finished epoch 01 in 0:28:40, average epoch loss = 0.9616
2024-05-01 08:52:09   Ranking results: msls_val R@1: 0.5595, R@5: 0.7068, R@10: 0.7541, R@15: 0.7743, R@20: 0.7973, R@50: 0.8432, R@100: 0.8770
2024-05-01 08:52:16   Improved: previous msls-val best R@1 = 0.5000, current R@1 = 0.5595
2024-05-01 08:52:16   Start training epoch: 02
2024-05-01 09:20:52   Finished epoch 02 in 0:28:35, average epoch loss = 0.9001
2024-05-01 09:22:16   Ranking results: msls_val R@1: 0.5811, R@5: 0.7311, R@10: 0.7730, R@15: 0.7932, R@20: 0.8068, R@50: 0.8514, R@100: 0.8824
2024-05-01 09:22:24   Improved: previous msls-val best R@1 = 0.5595, current R@1 = 0.5811
2024-05-01 09:22:24   Start training epoch: 03
2024-05-01 09:51:03   Finished epoch 03 in 0:28:39, average epoch loss = 0.8538
2024-05-01 09:52:27   Ranking results: msls_val R@1: 0.5865, R@5: 0.7351, R@10: 0.7743, R@15: 0.7905, R@20: 0.8162, R@50: 0.8595, R@100: 0.8851
2024-05-01 09:52:34   Improved: previous msls-val best R@1 = 0.5811, current R@1 = 0.5865
2024-05-01 09:52:34   Start training epoch: 04
2024-05-01 10:21:08   Finished epoch 04 in 0:28:33, average epoch loss = 0.8256
2024-05-01 10:22:33   Ranking results: msls_val R@1: 0.5946, R@5: 0.7459, R@10: 0.7757, R@15: 0.7932, R@20: 0.8081, R@50: 0.8541, R@100: 0.8905
2024-05-01 10:22:42   Improved: previous msls-val best R@1 = 0.5865, current R@1 = 0.5946
2024-05-01 10:22:42   Start training epoch: 05
2024-05-01 10:51:15   Finished epoch 05 in 0:28:32, average epoch loss = 0.8053
2024-05-01 10:52:38   Ranking results: msls_val R@1: 0.5986, R@5: 0.7311, R@10: 0.7784, R@15: 0.7946, R@20: 0.8149, R@50: 0.8595, R@100: 0.8865
2024-05-01 10:52:45   Improved: previous msls-val best R@1 = 0.5946, current R@1 = 0.5986
2024-05-01 10:52:45   Start training epoch: 06
2024-05-01 11:21:22   Finished epoch 06 in 0:28:37, average epoch loss = 0.7826
2024-05-01 11:22:48   Ranking results: msls_val R@1: 0.6054, R@5: 0.7378, R@10: 0.7743, R@15: 0.7959, R@20: 0.8108, R@50: 0.8608, R@100: 0.8851
2024-05-01 11:22:55   Improved: previous msls-val best R@1 = 0.5986, current R@1 = 0.6054
2024-05-01 11:22:55   Start training epoch: 07
2024-05-01 11:51:30   Finished epoch 07 in 0:28:34, average epoch loss = 0.7703
2024-05-01 11:52:55   Ranking results: msls_val R@1: 0.6122, R@5: 0.7527, R@10: 0.7757, R@15: 0.8041, R@20: 0.8203, R@50: 0.8595, R@100: 0.8824
2024-05-01 11:53:01   Improved: previous msls-val best R@1 = 0.6054, current R@1 = 0.6122
2024-05-01 11:53:01   Start training epoch: 08
2024-05-01 12:21:56   Finished epoch 08 in 0:28:54, average epoch loss = 0.7569
2024-05-01 12:23:19   Ranking results: msls_val R@1: 0.6162, R@5: 0.7405, R@10: 0.7811, R@15: 0.8041, R@20: 0.8122, R@50: 0.8622, R@100: 0.8878
2024-05-01 12:23:26   Improved: previous msls-val best R@1 = 0.6122, current R@1 = 0.6162
2024-05-01 12:23:26   Start training epoch: 09
2024-05-01 12:51:58   Finished epoch 09 in 0:28:32, average epoch loss = 0.7506
2024-05-01 12:53:23   Ranking results: msls_val R@1: 0.6149, R@5: 0.7473, R@10: 0.7757, R@15: 0.7946, R@20: 0.8122, R@50: 0.8581, R@100: 0.8905
2024-05-01 12:53:27   Not improved: 1 / 3: msls-val best R@1 = 0.6162, current R@1 = 0.6149
2024-05-01 12:53:27   Start training epoch: 10
2024-05-01 13:21:57   Finished epoch 10 in 0:28:29, average epoch loss = 0.7414
2024-05-01 13:23:22   Ranking results: msls_val R@1: 0.6122, R@5: 0.7405, R@10: 0.7784, R@15: 0.8014, R@20: 0.8149, R@50: 0.8595, R@100: 0.8878
2024-05-01 13:23:25   Not improved: 2 / 3: msls-val best R@1 = 0.6162, current R@1 = 0.6122
2024-05-01 13:23:25   Start training epoch: 11
2024-05-01 13:51:50   Finished epoch 11 in 0:28:24, average epoch loss = 0.7351
2024-05-01 13:53:12   Ranking results: msls_val R@1: 0.6176, R@5: 0.7432, R@10: 0.7865, R@15: 0.8027, R@20: 0.8135, R@50: 0.8622, R@100: 0.8892
2024-05-01 13:53:19   Improved: previous msls-val best R@1 = 0.6162, current R@1 = 0.6176
2024-05-01 13:53:19   Start training epoch: 12
2024-05-01 14:21:53   Finished epoch 12 in 0:28:34, average epoch loss = 0.7292
2024-05-01 14:23:18   Ranking results: msls_val R@1: 0.6203, R@5: 0.7500, R@10: 0.7838, R@15: 0.8041, R@20: 0.8176, R@50: 0.8649, R@100: 0.8905
2024-05-01 14:23:25   Improved: previous msls-val best R@1 = 0.6176, current R@1 = 0.6203
2024-05-01 14:23:25   Start training epoch: 13
2024-05-01 14:51:59   Finished epoch 13 in 0:28:34, average epoch loss = 0.7261
2024-05-01 14:53:25   Ranking results: msls_val R@1: 0.6176, R@5: 0.7527, R@10: 0.7811, R@15: 0.7986, R@20: 0.8122, R@50: 0.8662, R@100: 0.8851
2024-05-01 14:53:28   Not improved: 1 / 3: msls-val best R@1 = 0.6203, current R@1 = 0.6176
2024-05-01 14:53:28   Start training epoch: 14
2024-05-01 15:21:44   Finished epoch 14 in 0:28:15, average epoch loss = 0.7230
2024-05-01 15:23:02   Ranking results: msls_val R@1: 0.6176, R@5: 0.7486, R@10: 0.7824, R@15: 0.7986, R@20: 0.8162, R@50: 0.8676, R@100: 0.8878
2024-05-01 15:23:06   Not improved: 2 / 3: msls-val best R@1 = 0.6203, current R@1 = 0.6176
2024-05-01 15:23:06   Start training epoch: 15
2024-05-01 15:46:26   Finished epoch 15 in 0:23:19, average epoch loss = 0.7224
2024-05-01 15:47:19   Ranking results: msls_val R@1: 0.6203, R@5: 0.7473, R@10: 0.7797, R@15: 0.8027, R@20: 0.8135, R@50: 0.8676, R@100: 0.8851
2024-05-01 15:47:23   Not improved: 3 / 3: msls-val best R@1 = 0.6203, current R@1 = 0.6203
2024-05-01 15:47:23   Performance did not improve for 3 epochs. Stop training.
2024-05-01 15:47:23   Best  msls-val best R@1 = 0.6203
2024-05-01 15:47:23   Trained for 16 epochs, in total in 7:56:00
2024-05-01 15:47:23   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 15:47:23   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-01 15:47:23   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-01 15:47:23   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-01 15:47:23   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-01 15:47:23   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-01 15:47:23   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-01 15:47:24   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-01 15:47:24   Test *best* model on test set
2024-05-01 15:48:38   Ranking results: msls_val R@1: 0.6203, R@5: 0.7500, R@10: 0.7838, R@15: 0.8041, R@20: 0.8176, R@50: 0.8649, R@100: 0.8905
2024-05-01 15:54:56   Ranking results: tokyo247 R@1: 0.2482, R@5: 0.3286, R@10: 0.3499, R@15: 0.3593, R@20: 0.3712, R@50: 0.3924, R@100: 0.4137
2024-05-01 15:55:02   Ranking results: SPED R@1: 0.5552, R@5: 0.7249, R@10: 0.7842, R@15: 0.8105, R@20: 0.8287, R@50: 0.8913, R@100: 0.9456
2024-05-01 15:57:01   Ranking results: nordland R@1: 0.0507, R@5: 0.0917, R@10: 0.1167, R@15: 0.1399, R@20: 0.1522, R@50: 0.2130, R@100: 0.2812
2024-05-01 15:58:11   Ranking results: pitts30k_val R@1: 0.7326, R@5: 0.8178, R@10: 0.8327, R@15: 0.8387, R@20: 0.8433, R@50: 0.9359, R@100: 0.9815
2024-05-01 15:59:18   Ranking results: pitts30k_test R@1: 0.7173, R@5: 0.8216, R@10: 0.8501, R@15: 0.8712, R@20: 0.9013, R@50: 0.9535, R@100: 0.9711
2024-05-01 16:06:35   Ranking results: pitts250k_test R@1: 0.6575, R@5: 0.7539, R@10: 0.7826, R@15: 0.8005, R@20: 0.8117, R@50: 0.8498, R@100: 0.8725
2024-05-01 16:13:16   Ranking results: pitts250k_val R@1: 0.6618, R@5: 0.7415, R@10: 0.7668, R@15: 0.7851, R@20: 0.7982, R@50: 0.8398, R@100: 0.8881
2024-05-01 16:13:16   Test *last* model on test set
2024-05-01 16:14:01   Ranking results: msls_val R@1: 0.6203, R@5: 0.7473, R@10: 0.7797, R@15: 0.8027, R@20: 0.8135, R@50: 0.8676, R@100: 0.8851
2024-05-01 16:20:14   Ranking results: tokyo247 R@1: 0.2199, R@5: 0.2790, R@10: 0.2931, R@15: 0.3050, R@20: 0.3121, R@50: 0.3357, R@100: 0.3546
2024-05-01 16:20:19   Ranking results: SPED R@1: 0.5502, R@5: 0.7265, R@10: 0.7858, R@15: 0.8122, R@20: 0.8254, R@50: 0.8929, R@100: 0.9456
2024-05-01 16:21:34   Ranking results: nordland R@1: 0.0500, R@5: 0.0924, R@10: 0.1163, R@15: 0.1409, R@20: 0.1514, R@50: 0.2130, R@100: 0.2757
2024-05-01 16:22:24   Ranking results: pitts30k_val R@1: 0.7140, R@5: 0.7911, R@10: 0.8080, R@15: 0.8126, R@20: 0.8176, R@50: 0.9347, R@100: 0.9829
2024-05-01 16:23:11   Ranking results: pitts30k_test R@1: 0.7063, R@5: 0.8056, R@10: 0.8320, R@15: 0.8618, R@20: 0.8995, R@50: 0.9544, R@100: 0.9715
2024-05-01 16:28:04   Ranking results: pitts250k_test R@1: 0.6551, R@5: 0.7455, R@10: 0.7751, R@15: 0.7938, R@20: 0.8033, R@50: 0.8373, R@100: 0.8565
2024-05-01 16:32:28   Ranking results: pitts250k_val R@1: 0.6600, R@5: 0.7395, R@10: 0.7614, R@15: 0.7775, R@20: 0.7882, R@50: 0.8228, R@100: 0.8853
