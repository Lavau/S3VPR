2024-05-05 11:24:18   Arguments: Namespace(aggregator_name='token_module', backbone_name='shufflenet_v2_x0_5', device='cuda', dim=1024, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-05_11-24-18-shufflenet_v2_x0_5-token_module', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-05 11:24:18   The outputs are being saved in logs/2024-05-05_11-24-18-shufflenet_v2_x0_5-token_module
2024-05-05 11:24:18   validation dataset names:['msls_val']
2024-05-05 11:24:18   Using 2 GPUs and 64 CPUs
2024-05-05 11:24:22   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-05 11:24:22   Start training epoch: 00
2024-05-05 11:34:02   Finished epoch 00 in 0:09:39, average epoch loss = 1.5045
2024-05-05 11:34:34   Ranking results: msls_val R@1: 0.3108, R@5: 0.4554, R@10: 0.5081, R@15: 0.5378, R@20: 0.5689, R@50: 0.6676, R@100: 0.7243
2024-05-05 11:34:34   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.3108
2024-05-05 11:34:34   Start training epoch: 01
2024-05-05 11:44:09   Finished epoch 01 in 0:09:35, average epoch loss = 1.4048
2024-05-05 11:44:40   Ranking results: msls_val R@1: 0.3568, R@5: 0.5027, R@10: 0.5568, R@15: 0.6027, R@20: 0.6324, R@50: 0.6973, R@100: 0.7473
2024-05-05 11:44:41   Improved: previous msls-val best R@1 = 0.3108, current R@1 = 0.3568
2024-05-05 11:44:41   Start training epoch: 02
2024-05-05 11:54:18   Finished epoch 02 in 0:09:37, average epoch loss = 1.3735
2024-05-05 11:54:50   Ranking results: msls_val R@1: 0.3689, R@5: 0.5081, R@10: 0.5608, R@15: 0.6027, R@20: 0.6297, R@50: 0.7054, R@100: 0.7568
2024-05-05 11:54:50   Improved: previous msls-val best R@1 = 0.3568, current R@1 = 0.3689
2024-05-05 11:54:50   Start training epoch: 03
2024-05-05 12:04:24   Finished epoch 03 in 0:09:33, average epoch loss = 1.3502
2024-05-05 12:04:55   Ranking results: msls_val R@1: 0.3838, R@5: 0.5149, R@10: 0.5770, R@15: 0.6135, R@20: 0.6324, R@50: 0.7054, R@100: 0.7689
2024-05-05 12:04:56   Improved: previous msls-val best R@1 = 0.3689, current R@1 = 0.3838
2024-05-05 12:04:56   Start training epoch: 04
2024-05-05 12:14:37   Finished epoch 04 in 0:09:40, average epoch loss = 1.3422
2024-05-05 12:15:07   Ranking results: msls_val R@1: 0.3838, R@5: 0.5311, R@10: 0.5797, R@15: 0.6095, R@20: 0.6432, R@50: 0.7108, R@100: 0.7635
2024-05-05 12:15:08   Not improved: 1 / 3: msls-val best R@1 = 0.3838, current R@1 = 0.3838
2024-05-05 12:15:08   Start training epoch: 05
2024-05-05 12:24:48   Finished epoch 05 in 0:09:40, average epoch loss = 1.3321
2024-05-05 12:25:19   Ranking results: msls_val R@1: 0.3905, R@5: 0.5392, R@10: 0.5959, R@15: 0.6257, R@20: 0.6500, R@50: 0.7203, R@100: 0.7743
2024-05-05 12:25:20   Improved: previous msls-val best R@1 = 0.3838, current R@1 = 0.3905
2024-05-05 12:25:20   Start training epoch: 06
2024-05-05 12:34:52   Finished epoch 06 in 0:09:32, average epoch loss = 1.3228
2024-05-05 12:35:22   Ranking results: msls_val R@1: 0.3986, R@5: 0.5338, R@10: 0.5986, R@15: 0.6419, R@20: 0.6595, R@50: 0.7149, R@100: 0.7838
2024-05-05 12:35:23   Improved: previous msls-val best R@1 = 0.3905, current R@1 = 0.3986
2024-05-05 12:35:23   Start training epoch: 07
2024-05-05 12:44:58   Finished epoch 07 in 0:09:34, average epoch loss = 1.3186
2024-05-05 12:45:29   Ranking results: msls_val R@1: 0.3892, R@5: 0.5405, R@10: 0.6081, R@15: 0.6405, R@20: 0.6581, R@50: 0.7243, R@100: 0.7878
2024-05-05 12:45:29   Not improved: 1 / 3: msls-val best R@1 = 0.3986, current R@1 = 0.3892
2024-05-05 12:45:29   Start training epoch: 08
2024-05-05 12:55:16   Finished epoch 08 in 0:09:46, average epoch loss = 1.3147
2024-05-05 12:55:48   Ranking results: msls_val R@1: 0.4014, R@5: 0.5527, R@10: 0.6149, R@15: 0.6459, R@20: 0.6622, R@50: 0.7324, R@100: 0.7824
2024-05-05 12:55:48   Improved: previous msls-val best R@1 = 0.3986, current R@1 = 0.4014
2024-05-05 12:55:48   Start training epoch: 09
2024-05-05 13:05:28   Finished epoch 09 in 0:09:40, average epoch loss = 1.3099
2024-05-05 13:05:59   Ranking results: msls_val R@1: 0.4014, R@5: 0.5486, R@10: 0.6122, R@15: 0.6378, R@20: 0.6527, R@50: 0.7311, R@100: 0.7797
2024-05-05 13:06:00   Not improved: 1 / 3: msls-val best R@1 = 0.4014, current R@1 = 0.4014
2024-05-05 13:06:00   Start training epoch: 10
2024-05-05 13:15:38   Finished epoch 10 in 0:09:38, average epoch loss = 1.3083
2024-05-05 13:16:10   Ranking results: msls_val R@1: 0.4000, R@5: 0.5581, R@10: 0.6122, R@15: 0.6365, R@20: 0.6527, R@50: 0.7365, R@100: 0.7797
2024-05-05 13:16:11   Not improved: 2 / 3: msls-val best R@1 = 0.4014, current R@1 = 0.4000
2024-05-05 13:16:11   Start training epoch: 11
2024-05-05 13:26:04   Finished epoch 11 in 0:09:52, average epoch loss = 1.3054
2024-05-05 13:26:37   Ranking results: msls_val R@1: 0.4054, R@5: 0.5541, R@10: 0.6068, R@15: 0.6378, R@20: 0.6635, R@50: 0.7459, R@100: 0.7824
2024-05-05 13:26:37   Improved: previous msls-val best R@1 = 0.4014, current R@1 = 0.4054
2024-05-05 13:26:37   Start training epoch: 12
2024-05-05 13:36:30   Finished epoch 12 in 0:09:52, average epoch loss = 1.3034
2024-05-05 13:37:01   Ranking results: msls_val R@1: 0.4054, R@5: 0.5541, R@10: 0.6068, R@15: 0.6378, R@20: 0.6541, R@50: 0.7405, R@100: 0.7784
2024-05-05 13:37:01   Not improved: 1 / 3: msls-val best R@1 = 0.4054, current R@1 = 0.4054
2024-05-05 13:37:01   Start training epoch: 13
2024-05-05 13:46:30   Finished epoch 13 in 0:09:28, average epoch loss = 1.3029
2024-05-05 13:47:00   Ranking results: msls_val R@1: 0.4041, R@5: 0.5595, R@10: 0.6135, R@15: 0.6419, R@20: 0.6622, R@50: 0.7419, R@100: 0.7838
2024-05-05 13:47:01   Not improved: 2 / 3: msls-val best R@1 = 0.4054, current R@1 = 0.4041
2024-05-05 13:47:01   Start training epoch: 14
2024-05-05 13:56:32   Finished epoch 14 in 0:09:31, average epoch loss = 1.3011
2024-05-05 13:57:04   Ranking results: msls_val R@1: 0.4000, R@5: 0.5500, R@10: 0.6135, R@15: 0.6405, R@20: 0.6622, R@50: 0.7392, R@100: 0.7784
2024-05-05 13:57:04   Not improved: 3 / 3: msls-val best R@1 = 0.4054, current R@1 = 0.4000
2024-05-05 13:57:04   Performance did not improve for 3 epochs. Stop training.
2024-05-05 13:57:04   Best  msls-val best R@1 = 0.4054
2024-05-05 13:57:04   Trained for 15 epochs, in total in 2:32:45
2024-05-05 13:57:04   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-05 13:57:04   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-05 13:57:04   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-05 13:57:04   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-05 13:57:04   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-05 13:57:04   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-05 13:57:05   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-05 13:57:05   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-05 13:57:05   Test *best* model on test set
2024-05-05 13:57:37   Ranking results: msls_val R@1: 0.4054, R@5: 0.5541, R@10: 0.6068, R@15: 0.6378, R@20: 0.6635, R@50: 0.7459, R@100: 0.7824
2024-05-05 14:03:54   Ranking results: tokyo247 R@1: 0.2222, R@5: 0.3428, R@10: 0.4232, R@15: 0.4610, R@20: 0.4894, R@50: 0.5934, R@100: 0.6548
2024-05-05 14:03:58   Ranking results: SPED R@1: 0.4975, R@5: 0.6672, R@10: 0.7315, R@15: 0.7727, R@20: 0.8023, R@50: 0.8797, R@100: 0.9176
2024-05-05 14:04:49   Ranking results: nordland R@1: 0.0243, R@5: 0.0493, R@10: 0.0663, R@15: 0.0793, R@20: 0.0902, R@50: 0.1435, R@100: 0.1902
2024-05-05 14:05:26   Ranking results: pitts30k_val R@1: 0.6710, R@5: 0.8375, R@10: 0.8872, R@15: 0.9117, R@20: 0.9276, R@50: 0.9657, R@100: 0.9841
2024-05-05 14:06:02   Ranking results: pitts30k_test R@1: 0.6853, R@5: 0.8289, R@10: 0.8735, R@15: 0.8957, R@20: 0.9102, R@50: 0.9503, R@100: 0.9674
2024-05-05 14:09:52   Ranking results: pitts250k_test R@1: 0.6150, R@5: 0.7496, R@10: 0.7874, R@15: 0.8070, R@20: 0.8197, R@50: 0.8566, R@100: 0.8862
2024-05-05 14:13:11   Ranking results: pitts250k_val R@1: 0.5900, R@5: 0.7215, R@10: 0.7637, R@15: 0.7877, R@20: 0.8026, R@50: 0.8490, R@100: 0.8814
2024-05-05 14:13:11   Test *last* model on test set
2024-05-05 14:13:43   Ranking results: msls_val R@1: 0.4000, R@5: 0.5500, R@10: 0.6135, R@15: 0.6405, R@20: 0.6622, R@50: 0.7392, R@100: 0.7784
2024-05-05 14:20:02   Ranking results: tokyo247 R@1: 0.2175, R@5: 0.3499, R@10: 0.4232, R@15: 0.4728, R@20: 0.4846, R@50: 0.5863, R@100: 0.6525
2024-05-05 14:20:05   Ranking results: SPED R@1: 0.5074, R@5: 0.6672, R@10: 0.7397, R@15: 0.7677, R@20: 0.7924, R@50: 0.8764, R@100: 0.9160
2024-05-05 14:20:56   Ranking results: nordland R@1: 0.0239, R@5: 0.0518, R@10: 0.0667, R@15: 0.0790, R@20: 0.0899, R@50: 0.1449, R@100: 0.1920
2024-05-05 14:21:35   Ranking results: pitts30k_val R@1: 0.6742, R@5: 0.8396, R@10: 0.8879, R@15: 0.9109, R@20: 0.9282, R@50: 0.9656, R@100: 0.9842
2024-05-05 14:22:10   Ranking results: pitts30k_test R@1: 0.6837, R@5: 0.8283, R@10: 0.8738, R@15: 0.8960, R@20: 0.9117, R@50: 0.9489, R@100: 0.9673
2024-05-05 14:25:54   Ranking results: pitts250k_test R@1: 0.6167, R@5: 0.7495, R@10: 0.7865, R@15: 0.8058, R@20: 0.8184, R@50: 0.8570, R@100: 0.8850
2024-05-05 14:29:15   Ranking results: pitts250k_val R@1: 0.5925, R@5: 0.7267, R@10: 0.7655, R@15: 0.7861, R@20: 0.8024, R@50: 0.8492, R@100: 0.8824
