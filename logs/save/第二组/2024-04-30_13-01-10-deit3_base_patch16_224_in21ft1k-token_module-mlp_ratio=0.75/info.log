2024-04-30 13:01:10   Arguments: Namespace(aggregator_name='token_module', backbone_name='deit3_base_patch16_224_in21ft1k', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=5, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-04-30_13-01-10', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-04-30 13:01:10   The outputs are being saved in logs/2024-04-30_13-01-10
2024-04-30 13:01:10   validation dataset names:['msls_val']
2024-04-30 13:01:10   Using 2 GPUs and 64 CPUs
2024-04-30 13:01:11   Loading pretrained weights from url (https://dl.fbaipublicfiles.com/deit/deit_3_base_224_21k.pth)
2024-04-30 13:01:14   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-04-30 13:01:14   Start training epoch: 00
2024-04-30 13:16:46   Finished epoch 00 in 0:15:31, average epoch loss = 1.1165
2024-04-30 13:17:34   Ranking results: msls_val R@1: 0.6824, R@5: 0.8122, R@10: 0.8649, R@15: 0.8838, R@20: 0.8905, R@50: 0.9243, R@100: 0.9500
2024-04-30 13:17:36   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.6824
2024-04-30 13:17:36   Start training epoch: 01
2024-04-30 13:33:04   Finished epoch 01 in 0:15:28, average epoch loss = 0.8539
2024-04-30 13:33:53   Ranking results: msls_val R@1: 0.7095, R@5: 0.8486, R@10: 0.8797, R@15: 0.8919, R@20: 0.9068, R@50: 0.9392, R@100: 0.9554
2024-04-30 13:34:00   Improved: previous msls-val best R@1 = 0.6824, current R@1 = 0.7095
2024-04-30 13:34:00   Start training epoch: 02
2024-04-30 13:49:29   Finished epoch 02 in 0:15:29, average epoch loss = 0.7693
2024-04-30 13:50:18   Ranking results: msls_val R@1: 0.7257, R@5: 0.8527, R@10: 0.8865, R@15: 0.9027, R@20: 0.9108, R@50: 0.9432, R@100: 0.9608
2024-04-30 13:50:26   Improved: previous msls-val best R@1 = 0.7095, current R@1 = 0.7257
2024-04-30 13:50:26   Start training epoch: 03
2024-04-30 14:05:53   Finished epoch 03 in 0:15:27, average epoch loss = 0.7022
2024-04-30 14:06:41   Ranking results: msls_val R@1: 0.7297, R@5: 0.8622, R@10: 0.8973, R@15: 0.9149, R@20: 0.9270, R@50: 0.9500, R@100: 0.9676
2024-04-30 14:06:49   Improved: previous msls-val best R@1 = 0.7257, current R@1 = 0.7297
2024-04-30 14:06:49   Start training epoch: 04
2024-04-30 14:22:17   Finished epoch 04 in 0:15:27, average epoch loss = 0.6740
2024-04-30 14:23:05   Ranking results: msls_val R@1: 0.7459, R@5: 0.8608, R@10: 0.8932, R@15: 0.9149, R@20: 0.9189, R@50: 0.9541, R@100: 0.9676
2024-04-30 14:23:13   Improved: previous msls-val best R@1 = 0.7297, current R@1 = 0.7459
2024-04-30 14:23:13   Start training epoch: 05
2024-04-30 14:42:28   Finished epoch 05 in 0:19:14, average epoch loss = 0.6470
2024-04-30 14:43:48   Ranking results: msls_val R@1: 0.7554, R@5: 0.8662, R@10: 0.8946, R@15: 0.9135, R@20: 0.9311, R@50: 0.9622, R@100: 0.9689
2024-04-30 14:43:55   Improved: previous msls-val best R@1 = 0.7459, current R@1 = 0.7554
2024-04-30 14:43:55   Start training epoch: 06
2024-04-30 15:11:11   Finished epoch 06 in 0:27:15, average epoch loss = 0.6237
2024-04-30 15:12:27   Ranking results: msls_val R@1: 0.7581, R@5: 0.8649, R@10: 0.8959, R@15: 0.9135, R@20: 0.9216, R@50: 0.9622, R@100: 0.9662
2024-04-30 15:12:35   Improved: previous msls-val best R@1 = 0.7554, current R@1 = 0.7581
2024-04-30 15:12:35   Start training epoch: 07
2024-04-30 15:39:38   Finished epoch 07 in 0:27:02, average epoch loss = 0.6054
2024-04-30 15:40:53   Ranking results: msls_val R@1: 0.7568, R@5: 0.8635, R@10: 0.8973, R@15: 0.9081, R@20: 0.9257, R@50: 0.9568, R@100: 0.9635
2024-04-30 15:40:57   Not improved: 1 / 5: msls-val best R@1 = 0.7581, current R@1 = 0.7568
2024-04-30 15:40:57   Start training epoch: 08
2024-04-30 16:08:00   Finished epoch 08 in 0:27:03, average epoch loss = 0.5959
2024-04-30 16:09:17   Ranking results: msls_val R@1: 0.7486, R@5: 0.8716, R@10: 0.9027, R@15: 0.9203, R@20: 0.9311, R@50: 0.9568, R@100: 0.9649
2024-04-30 16:09:21   Not improved: 2 / 5: msls-val best R@1 = 0.7581, current R@1 = 0.7486
2024-04-30 16:09:21   Start training epoch: 09
2024-04-30 16:36:31   Finished epoch 09 in 0:27:09, average epoch loss = 0.5859
2024-04-30 16:37:42   Ranking results: msls_val R@1: 0.7568, R@5: 0.8716, R@10: 0.8973, R@15: 0.9162, R@20: 0.9324, R@50: 0.9581, R@100: 0.9649
2024-04-30 16:37:45   Not improved: 3 / 5: msls-val best R@1 = 0.7581, current R@1 = 0.7568
2024-04-30 16:37:45   Start training epoch: 10
2024-04-30 17:05:02   Finished epoch 10 in 0:27:16, average epoch loss = 0.5764
2024-04-30 17:06:15   Ranking results: msls_val R@1: 0.7595, R@5: 0.8649, R@10: 0.9014, R@15: 0.9203, R@20: 0.9284, R@50: 0.9608, R@100: 0.9649
2024-04-30 17:06:23   Improved: previous msls-val best R@1 = 0.7581, current R@1 = 0.7595
2024-04-30 17:06:23   Start training epoch: 11
2024-04-30 17:28:52   Finished epoch 11 in 0:22:28, average epoch loss = 0.5695
2024-04-30 17:29:52   Ranking results: msls_val R@1: 0.7608, R@5: 0.8689, R@10: 0.9027, R@15: 0.9230, R@20: 0.9257, R@50: 0.9595, R@100: 0.9635
2024-04-30 17:30:00   Improved: previous msls-val best R@1 = 0.7595, current R@1 = 0.7608
2024-04-30 17:30:00   Start training epoch: 12
2024-04-30 17:49:12   Finished epoch 12 in 0:19:11, average epoch loss = 0.5662
2024-04-30 17:50:01   Ranking results: msls_val R@1: 0.7514, R@5: 0.8716, R@10: 0.9027, R@15: 0.9203, R@20: 0.9270, R@50: 0.9595, R@100: 0.9649
2024-04-30 17:50:05   Not improved: 1 / 5: msls-val best R@1 = 0.7608, current R@1 = 0.7514
2024-04-30 17:50:05   Start training epoch: 13
2024-04-30 18:05:29   Finished epoch 13 in 0:15:24, average epoch loss = 0.5619
2024-04-30 18:06:17   Ranking results: msls_val R@1: 0.7500, R@5: 0.8703, R@10: 0.9041, R@15: 0.9216, R@20: 0.9297, R@50: 0.9595, R@100: 0.9649
2024-04-30 18:06:21   Not improved: 2 / 5: msls-val best R@1 = 0.7608, current R@1 = 0.7500
2024-04-30 18:06:21   Start training epoch: 14
2024-04-30 18:21:46   Finished epoch 14 in 0:15:24, average epoch loss = 0.5585
2024-04-30 18:22:34   Ranking results: msls_val R@1: 0.7527, R@5: 0.8703, R@10: 0.9014, R@15: 0.9176, R@20: 0.9284, R@50: 0.9554, R@100: 0.9649
2024-04-30 18:22:38   Not improved: 3 / 5: msls-val best R@1 = 0.7608, current R@1 = 0.7527
2024-04-30 18:22:38   Start training epoch: 15
2024-04-30 18:38:04   Finished epoch 15 in 0:15:26, average epoch loss = 0.5569
2024-04-30 18:38:53   Ranking results: msls_val R@1: 0.7527, R@5: 0.8743, R@10: 0.9041, R@15: 0.9176, R@20: 0.9297, R@50: 0.9568, R@100: 0.9649
2024-04-30 18:38:57   Not improved: 4 / 5: msls-val best R@1 = 0.7608, current R@1 = 0.7527
2024-04-30 18:38:57   Start training epoch: 16
2024-04-30 18:54:25   Finished epoch 16 in 0:15:27, average epoch loss = 0.5539
2024-04-30 18:55:13   Ranking results: msls_val R@1: 0.7568, R@5: 0.8757, R@10: 0.9027, R@15: 0.9149, R@20: 0.9297, R@50: 0.9581, R@100: 0.9649
2024-04-30 18:55:17   Not improved: 5 / 5: msls-val best R@1 = 0.7608, current R@1 = 0.7568
2024-04-30 18:55:17   Performance did not improve for 5 epochs. Stop training.
2024-04-30 18:55:17   Best  msls-val best R@1 = 0.7608
2024-04-30 18:55:17   Trained for 17 epochs, in total in 5:54:07
2024-04-30 18:55:17   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-04-30 18:55:17   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-04-30 18:55:17   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-04-30 18:55:17   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-04-30 18:55:17   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-04-30 18:55:17   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-04-30 18:55:17   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-04-30 18:55:18   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-04-30 18:55:18   Test *best* model on test set
2024-04-30 18:56:07   Ranking results: msls_val R@1: 0.7608, R@5: 0.8689, R@10: 0.9027, R@15: 0.9230, R@20: 0.9257, R@50: 0.9595, R@100: 0.9635
2024-04-30 19:02:25   Ranking results: tokyo247 R@1: 0.5910, R@5: 0.7636, R@10: 0.8298, R@15: 0.8511, R@20: 0.8652, R@50: 0.9007, R@100: 0.9291
2024-04-30 19:02:30   Ranking results: SPED R@1: 0.6820, R@5: 0.8287, R@10: 0.8748, R@15: 0.8896, R@20: 0.9127, R@50: 0.9539, R@100: 0.9736
2024-04-30 19:03:51   Ranking results: nordland R@1: 0.1011, R@5: 0.1822, R@10: 0.2279, R@15: 0.2562, R@20: 0.2793, R@50: 0.3656, R@100: 0.4399
2024-04-30 19:04:44   Ranking results: pitts30k_val R@1: 0.8834, R@5: 0.9734, R@10: 0.9882, R@15: 0.9921, R@20: 0.9941, R@50: 0.9974, R@100: 0.9992
2024-04-30 19:05:34   Ranking results: pitts30k_test R@1: 0.8710, R@5: 0.9441, R@10: 0.9620, R@15: 0.9711, R@20: 0.9751, R@50: 0.9839, R@100: 0.9905
2024-04-30 19:10:44   Ranking results: pitts250k_test R@1: 0.8918, R@5: 0.9640, R@10: 0.9780, R@15: 0.9848, R@20: 0.9880, R@50: 0.9946, R@100: 0.9963
2024-04-30 19:15:20   Ranking results: pitts250k_val R@1: 0.8732, R@5: 0.9635, R@10: 0.9773, R@15: 0.9844, R@20: 0.9880, R@50: 0.9943, R@100: 0.9966
2024-04-30 19:15:20   Test *last* model on test set
2024-04-30 19:16:09   Ranking results: msls_val R@1: 0.7568, R@5: 0.8757, R@10: 0.9027, R@15: 0.9149, R@20: 0.9297, R@50: 0.9581, R@100: 0.9649
2024-04-30 19:22:24   Ranking results: tokyo247 R@1: 0.5934, R@5: 0.7612, R@10: 0.8416, R@15: 0.8605, R@20: 0.8676, R@50: 0.9078, R@100: 0.9267
2024-04-30 19:22:29   Ranking results: SPED R@1: 0.6870, R@5: 0.8287, R@10: 0.8764, R@15: 0.8946, R@20: 0.9160, R@50: 0.9522, R@100: 0.9736
2024-04-30 19:23:49   Ranking results: nordland R@1: 0.1000, R@5: 0.1844, R@10: 0.2261, R@15: 0.2576, R@20: 0.2808, R@50: 0.3681, R@100: 0.4438
2024-04-30 19:24:41   Ranking results: pitts30k_val R@1: 0.8845, R@5: 0.9737, R@10: 0.9878, R@15: 0.9916, R@20: 0.9938, R@50: 0.9975, R@100: 0.9991
2024-04-30 19:25:31   Ranking results: pitts30k_test R@1: 0.8731, R@5: 0.9454, R@10: 0.9629, R@15: 0.9715, R@20: 0.9756, R@50: 0.9839, R@100: 0.9911
2024-04-30 19:30:38   Ranking results: pitts250k_test R@1: 0.8928, R@5: 0.9643, R@10: 0.9779, R@15: 0.9844, R@20: 0.9883, R@50: 0.9944, R@100: 0.9963
2024-04-30 19:35:14   Ranking results: pitts250k_val R@1: 0.8750, R@5: 0.9636, R@10: 0.9787, R@15: 0.9840, R@20: 0.9879, R@50: 0.9947, R@100: 0.9965
