2024-05-05 11:23:07   Arguments: Namespace(aggregator_name='token_module', backbone_name='shufflenet_v2_x2_0', device='cuda', dim=2048, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-05_11-23-07-shufflenet_v2_x2_0-token_module', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-05 11:23:07   The outputs are being saved in logs/2024-05-05_11-23-07-shufflenet_v2_x2_0-token_module
2024-05-05 11:23:07   validation dataset names:['msls_val']
2024-05-05 11:23:07   Using 2 GPUs and 64 CPUs
2024-05-05 11:23:10   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-05 11:23:10   Start training epoch: 00
2024-05-05 11:32:56   Finished epoch 00 in 0:09:46, average epoch loss = 1.4010
2024-05-05 11:33:27   Ranking results: msls_val R@1: 0.4216, R@5: 0.5486, R@10: 0.6108, R@15: 0.6311, R@20: 0.6676, R@50: 0.7459, R@100: 0.8014
2024-05-05 11:33:28   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.4216
2024-05-05 11:33:28   Start training epoch: 01
2024-05-05 11:43:03   Finished epoch 01 in 0:09:35, average epoch loss = 1.2746
2024-05-05 11:43:34   Ranking results: msls_val R@1: 0.4486, R@5: 0.5865, R@10: 0.6419, R@15: 0.6689, R@20: 0.6838, R@50: 0.7541, R@100: 0.7946
2024-05-05 11:43:34   Improved: previous msls-val best R@1 = 0.4216, current R@1 = 0.4486
2024-05-05 11:43:34   Start training epoch: 02
2024-05-05 11:53:11   Finished epoch 02 in 0:09:36, average epoch loss = 1.2095
2024-05-05 11:53:42   Ranking results: msls_val R@1: 0.4797, R@5: 0.6284, R@10: 0.6743, R@15: 0.6959, R@20: 0.7122, R@50: 0.7581, R@100: 0.8068
2024-05-05 11:53:43   Improved: previous msls-val best R@1 = 0.4486, current R@1 = 0.4797
2024-05-05 11:53:43   Start training epoch: 03
2024-05-05 12:03:22   Finished epoch 03 in 0:09:38, average epoch loss = 1.1591
2024-05-05 12:03:54   Ranking results: msls_val R@1: 0.5000, R@5: 0.6486, R@10: 0.6824, R@15: 0.7068, R@20: 0.7230, R@50: 0.7757, R@100: 0.8149
2024-05-05 12:03:55   Improved: previous msls-val best R@1 = 0.4797, current R@1 = 0.5000
2024-05-05 12:03:55   Start training epoch: 04
2024-05-05 12:13:27   Finished epoch 04 in 0:09:32, average epoch loss = 1.1297
2024-05-05 12:13:58   Ranking results: msls_val R@1: 0.5149, R@5: 0.6486, R@10: 0.6932, R@15: 0.7189, R@20: 0.7324, R@50: 0.7784, R@100: 0.8081
2024-05-05 12:13:59   Improved: previous msls-val best R@1 = 0.5000, current R@1 = 0.5149
2024-05-05 12:13:59   Start training epoch: 05
2024-05-05 12:23:39   Finished epoch 05 in 0:09:39, average epoch loss = 1.1052
2024-05-05 12:24:11   Ranking results: msls_val R@1: 0.5203, R@5: 0.6676, R@10: 0.6986, R@15: 0.7257, R@20: 0.7432, R@50: 0.8027, R@100: 0.8392
2024-05-05 12:24:12   Improved: previous msls-val best R@1 = 0.5149, current R@1 = 0.5203
2024-05-05 12:24:12   Start training epoch: 06
2024-05-05 12:33:58   Finished epoch 06 in 0:09:45, average epoch loss = 1.0792
2024-05-05 12:34:30   Ranking results: msls_val R@1: 0.5284, R@5: 0.6595, R@10: 0.7041, R@15: 0.7297, R@20: 0.7514, R@50: 0.7959, R@100: 0.8351
2024-05-05 12:34:31   Improved: previous msls-val best R@1 = 0.5203, current R@1 = 0.5284
2024-05-05 12:34:31   Start training epoch: 07
2024-05-05 12:44:21   Finished epoch 07 in 0:09:49, average epoch loss = 1.0707
2024-05-05 12:44:53   Ranking results: msls_val R@1: 0.5419, R@5: 0.6730, R@10: 0.7081, R@15: 0.7311, R@20: 0.7473, R@50: 0.8068, R@100: 0.8338
2024-05-05 12:44:54   Improved: previous msls-val best R@1 = 0.5284, current R@1 = 0.5419
2024-05-05 12:44:54   Start training epoch: 08
2024-05-05 12:54:38   Finished epoch 08 in 0:09:44, average epoch loss = 1.0606
2024-05-05 12:55:11   Ranking results: msls_val R@1: 0.5459, R@5: 0.6730, R@10: 0.7149, R@15: 0.7419, R@20: 0.7514, R@50: 0.8027, R@100: 0.8378
2024-05-05 12:55:12   Improved: previous msls-val best R@1 = 0.5419, current R@1 = 0.5459
2024-05-05 12:55:12   Start training epoch: 09
2024-05-05 13:05:00   Finished epoch 09 in 0:09:48, average epoch loss = 1.0467
2024-05-05 13:05:30   Ranking results: msls_val R@1: 0.5446, R@5: 0.6689, R@10: 0.7189, R@15: 0.7351, R@20: 0.7514, R@50: 0.8027, R@100: 0.8378
2024-05-05 13:05:31   Not improved: 1 / 3: msls-val best R@1 = 0.5459, current R@1 = 0.5446
2024-05-05 13:05:31   Start training epoch: 10
2024-05-05 13:15:21   Finished epoch 10 in 0:09:49, average epoch loss = 1.0427
2024-05-05 13:15:53   Ranking results: msls_val R@1: 0.5392, R@5: 0.6770, R@10: 0.7149, R@15: 0.7365, R@20: 0.7514, R@50: 0.8068, R@100: 0.8378
2024-05-05 13:15:53   Not improved: 2 / 3: msls-val best R@1 = 0.5459, current R@1 = 0.5392
2024-05-05 13:15:53   Start training epoch: 11
2024-05-05 13:25:42   Finished epoch 11 in 0:09:48, average epoch loss = 1.0347
2024-05-05 13:26:13   Ranking results: msls_val R@1: 0.5365, R@5: 0.6797, R@10: 0.7095, R@15: 0.7419, R@20: 0.7581, R@50: 0.8027, R@100: 0.8405
2024-05-05 13:26:14   Not improved: 3 / 3: msls-val best R@1 = 0.5459, current R@1 = 0.5365
2024-05-05 13:26:14   Performance did not improve for 3 epochs. Stop training.
2024-05-05 13:26:14   Best  msls-val best R@1 = 0.5459
2024-05-05 13:26:14   Trained for 12 epochs, in total in 2:03:07
2024-05-05 13:26:14   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-05 13:26:14   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-05 13:26:14   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-05 13:26:14   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-05 13:26:14   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-05 13:26:15   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-05 13:26:15   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-05 13:26:16   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-05 13:26:16   Test *best* model on test set
2024-05-05 13:26:47   Ranking results: msls_val R@1: 0.5459, R@5: 0.6730, R@10: 0.7149, R@15: 0.7419, R@20: 0.7514, R@50: 0.8027, R@100: 0.8378
2024-05-05 13:33:05   Ranking results: tokyo247 R@1: 0.2553, R@5: 0.3593, R@10: 0.4137, R@15: 0.4421, R@20: 0.4657, R@50: 0.5201, R@100: 0.5768
2024-05-05 13:33:07   Ranking results: SPED R@1: 0.5157, R@5: 0.6919, R@10: 0.7397, R@15: 0.7776, R@20: 0.7990, R@50: 0.8847, R@100: 0.9308
2024-05-05 13:34:02   Ranking results: nordland R@1: 0.0406, R@5: 0.0833, R@10: 0.1047, R@15: 0.1214, R@20: 0.1362, R@50: 0.1953, R@100: 0.2562
2024-05-05 13:34:43   Ranking results: pitts30k_val R@1: 0.7390, R@5: 0.8730, R@10: 0.9144, R@15: 0.9334, R@20: 0.9456, R@50: 0.9775, R@100: 0.9907
2024-05-05 13:35:20   Ranking results: pitts30k_test R@1: 0.7188, R@5: 0.8439, R@10: 0.8829, R@15: 0.9014, R@20: 0.9140, R@50: 0.9423, R@100: 0.9575
2024-05-05 13:39:25   Ranking results: pitts250k_test R@1: 0.6440, R@5: 0.7679, R@10: 0.8033, R@15: 0.8227, R@20: 0.8357, R@50: 0.8720, R@100: 0.8930
2024-05-05 13:42:58   Ranking results: pitts250k_val R@1: 0.6300, R@5: 0.7411, R@10: 0.7701, R@15: 0.7905, R@20: 0.8018, R@50: 0.8421, R@100: 0.8690
2024-05-05 13:42:58   Test *last* model on test set
2024-05-05 13:43:29   Ranking results: msls_val R@1: 0.5365, R@5: 0.6797, R@10: 0.7095, R@15: 0.7419, R@20: 0.7581, R@50: 0.8027, R@100: 0.8405
2024-05-05 13:49:51   Ranking results: tokyo247 R@1: 0.2482, R@5: 0.3357, R@10: 0.3593, R@15: 0.3877, R@20: 0.4043, R@50: 0.4846, R@100: 0.5366
2024-05-05 13:49:55   Ranking results: SPED R@1: 0.5140, R@5: 0.6870, R@10: 0.7529, R@15: 0.7694, R@20: 0.7858, R@50: 0.8781, R@100: 0.9390
2024-05-05 13:50:44   Ranking results: nordland R@1: 0.0431, R@5: 0.0841, R@10: 0.1101, R@15: 0.1250, R@20: 0.1362, R@50: 0.1996, R@100: 0.2605
2024-05-05 13:51:23   Ranking results: pitts30k_val R@1: 0.7194, R@5: 0.8437, R@10: 0.8935, R@15: 0.9151, R@20: 0.9326, R@50: 0.9732, R@100: 0.9896
2024-05-05 13:51:59   Ranking results: pitts30k_test R@1: 0.7135, R@5: 0.8386, R@10: 0.8754, R@15: 0.8944, R@20: 0.9073, R@50: 0.9412, R@100: 0.9561
2024-05-05 13:55:48   Ranking results: pitts250k_test R@1: 0.6173, R@5: 0.7283, R@10: 0.7653, R@15: 0.7820, R@20: 0.7953, R@50: 0.8342, R@100: 0.8595
2024-05-05 13:59:19   Ranking results: pitts250k_val R@1: 0.6155, R@5: 0.7167, R@10: 0.7499, R@15: 0.7668, R@20: 0.7800, R@50: 0.8173, R@100: 0.8478
