2024-05-01 08:20:24   Arguments: Namespace(aggregator_name='token_module', backbone_name='vit_b_32', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-01_08-20-24', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-01 08:20:24   The outputs are being saved in logs/2024-05-01_08-20-24
2024-05-01 08:20:24   validation dataset names:['msls_val']
2024-05-01 08:20:24   Using 2 GPUs and 64 CPUs
2024-05-01 08:20:29   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 08:20:29   Start training epoch: 00
2024-05-01 08:34:33   Finished epoch 00 in 0:14:03, average epoch loss = 1.3094
2024-05-01 08:35:16   Ranking results: msls_val R@1: 0.5203, R@5: 0.6743, R@10: 0.7297, R@15: 0.7635, R@20: 0.7784, R@50: 0.8311, R@100: 0.8635
2024-05-01 08:35:19   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.5203
2024-05-01 08:35:19   Start training epoch: 01
2024-05-01 08:49:52   Finished epoch 01 in 0:14:33, average epoch loss = 1.0951
2024-05-01 08:50:36   Ranking results: msls_val R@1: 0.5770, R@5: 0.7243, R@10: 0.7649, R@15: 0.7959, R@20: 0.8122, R@50: 0.8622, R@100: 0.8946
2024-05-01 08:50:44   Improved: previous msls-val best R@1 = 0.5203, current R@1 = 0.5770
2024-05-01 08:50:44   Start training epoch: 02
2024-05-01 09:05:18   Finished epoch 02 in 0:14:34, average epoch loss = 1.0396
2024-05-01 09:06:03   Ranking results: msls_val R@1: 0.6095, R@5: 0.7392, R@10: 0.7892, R@15: 0.8122, R@20: 0.8257, R@50: 0.8784, R@100: 0.9081
2024-05-01 09:06:10   Improved: previous msls-val best R@1 = 0.5770, current R@1 = 0.6095
2024-05-01 09:06:10   Start training epoch: 03
2024-05-01 09:20:41   Finished epoch 03 in 0:14:31, average epoch loss = 0.9978
2024-05-01 09:21:25   Ranking results: msls_val R@1: 0.6122, R@5: 0.7486, R@10: 0.7919, R@15: 0.8162, R@20: 0.8297, R@50: 0.8784, R@100: 0.8973
2024-05-01 09:21:31   Improved: previous msls-val best R@1 = 0.6095, current R@1 = 0.6122
2024-05-01 09:21:31   Start training epoch: 04
2024-05-01 09:35:56   Finished epoch 04 in 0:14:24, average epoch loss = 0.9784
2024-05-01 09:36:40   Ranking results: msls_val R@1: 0.6068, R@5: 0.7459, R@10: 0.7946, R@15: 0.8216, R@20: 0.8257, R@50: 0.8770, R@100: 0.9135
2024-05-01 09:36:44   Not improved: 1 / 3: msls-val best R@1 = 0.6122, current R@1 = 0.6068
2024-05-01 09:36:44   Start training epoch: 05
2024-05-01 09:51:20   Finished epoch 05 in 0:14:35, average epoch loss = 0.9611
2024-05-01 09:52:04   Ranking results: msls_val R@1: 0.6135, R@5: 0.7500, R@10: 0.7919, R@15: 0.8189, R@20: 0.8378, R@50: 0.8824, R@100: 0.9081
2024-05-01 09:52:11   Improved: previous msls-val best R@1 = 0.6122, current R@1 = 0.6135
2024-05-01 09:52:11   Start training epoch: 06
2024-05-01 10:06:44   Finished epoch 06 in 0:14:33, average epoch loss = 0.9460
2024-05-01 10:07:28   Ranking results: msls_val R@1: 0.6108, R@5: 0.7459, R@10: 0.7973, R@15: 0.8243, R@20: 0.8378, R@50: 0.8878, R@100: 0.9095
2024-05-01 10:07:32   Not improved: 1 / 3: msls-val best R@1 = 0.6135, current R@1 = 0.6108
2024-05-01 10:07:32   Start training epoch: 07
2024-05-01 10:21:52   Finished epoch 07 in 0:14:19, average epoch loss = 0.9347
2024-05-01 10:22:37   Ranking results: msls_val R@1: 0.6216, R@5: 0.7541, R@10: 0.7946, R@15: 0.8189, R@20: 0.8311, R@50: 0.8878, R@100: 0.9122
2024-05-01 10:22:46   Improved: previous msls-val best R@1 = 0.6135, current R@1 = 0.6216
2024-05-01 10:22:46   Start training epoch: 08
2024-05-01 10:35:12   Finished epoch 08 in 0:12:25, average epoch loss = 0.9270
2024-05-01 10:35:49   Ranking results: msls_val R@1: 0.6149, R@5: 0.7446, R@10: 0.7946, R@15: 0.8230, R@20: 0.8351, R@50: 0.8811, R@100: 0.9122
2024-05-01 10:35:53   Not improved: 1 / 3: msls-val best R@1 = 0.6216, current R@1 = 0.6149
2024-05-01 10:35:53   Start training epoch: 09
2024-05-01 10:48:03   Finished epoch 09 in 0:12:09, average epoch loss = 0.9163
2024-05-01 10:48:39   Ranking results: msls_val R@1: 0.6230, R@5: 0.7473, R@10: 0.7986, R@15: 0.8216, R@20: 0.8338, R@50: 0.8797, R@100: 0.9095
2024-05-01 10:48:47   Improved: previous msls-val best R@1 = 0.6216, current R@1 = 0.6230
2024-05-01 10:48:47   Start training epoch: 10
2024-05-01 11:00:40   Finished epoch 10 in 0:11:53, average epoch loss = 0.9131
2024-05-01 11:01:10   Ranking results: msls_val R@1: 0.6176, R@5: 0.7514, R@10: 0.7946, R@15: 0.8243, R@20: 0.8338, R@50: 0.8824, R@100: 0.9068
2024-05-01 11:01:14   Not improved: 1 / 3: msls-val best R@1 = 0.6230, current R@1 = 0.6176
2024-05-01 11:01:14   Start training epoch: 11
2024-05-01 11:12:03   Finished epoch 11 in 0:10:48, average epoch loss = 0.9042
2024-05-01 11:12:35   Ranking results: msls_val R@1: 0.6149, R@5: 0.7486, R@10: 0.7973, R@15: 0.8189, R@20: 0.8324, R@50: 0.8797, R@100: 0.9095
2024-05-01 11:12:39   Not improved: 2 / 3: msls-val best R@1 = 0.6230, current R@1 = 0.6149
2024-05-01 11:12:39   Start training epoch: 12
2024-05-01 11:22:47   Finished epoch 12 in 0:10:08, average epoch loss = 0.9009
2024-05-01 11:23:20   Ranking results: msls_val R@1: 0.6176, R@5: 0.7500, R@10: 0.7946, R@15: 0.8176, R@20: 0.8351, R@50: 0.8784, R@100: 0.9135
2024-05-01 11:23:23   Not improved: 3 / 3: msls-val best R@1 = 0.6230, current R@1 = 0.6176
2024-05-01 11:23:23   Performance did not improve for 3 epochs. Stop training.
2024-05-01 11:23:23   Best  msls-val best R@1 = 0.6230
2024-05-01 11:23:23   Trained for 13 epochs, in total in 3:02:59
2024-05-01 11:23:23   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 11:23:23   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-01 11:23:23   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-01 11:23:23   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-01 11:23:24   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-01 11:23:24   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-01 11:23:24   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-01 11:23:25   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-01 11:23:25   Test *best* model on test set
2024-05-01 11:23:59   Ranking results: msls_val R@1: 0.6230, R@5: 0.7473, R@10: 0.7986, R@15: 0.8216, R@20: 0.8338, R@50: 0.8797, R@100: 0.9095
2024-05-01 11:30:15   Ranking results: tokyo247 R@1: 0.4870, R@5: 0.6076, R@10: 0.6879, R@15: 0.7163, R@20: 0.7305, R@50: 0.8061, R@100: 0.8511
2024-05-01 11:30:19   Ranking results: SPED R@1: 0.6623, R@5: 0.7776, R@10: 0.8254, R@15: 0.8583, R@20: 0.8830, R@50: 0.9308, R@100: 0.9638
2024-05-01 11:31:15   Ranking results: nordland R@1: 0.1152, R@5: 0.2152, R@10: 0.2569, R@15: 0.2899, R@20: 0.3123, R@50: 0.3967, R@100: 0.4743
2024-05-01 11:31:54   Ranking results: pitts30k_val R@1: 0.8329, R@5: 0.9456, R@10: 0.9685, R@15: 0.9767, R@20: 0.9812, R@50: 0.9903, R@100: 0.9955
2024-05-01 11:32:30   Ranking results: pitts30k_test R@1: 0.8197, R@5: 0.9221, R@10: 0.9473, R@15: 0.9577, R@20: 0.9649, R@50: 0.9773, R@100: 0.9839
2024-05-01 11:36:18   Ranking results: pitts250k_test R@1: 0.8226, R@5: 0.9286, R@10: 0.9516, R@15: 0.9624, R@20: 0.9682, R@50: 0.9792, R@100: 0.9867
2024-05-01 11:39:47   Ranking results: pitts250k_val R@1: 0.8109, R@5: 0.9201, R@10: 0.9415, R@15: 0.9497, R@20: 0.9560, R@50: 0.9727, R@100: 0.9812
2024-05-01 11:39:47   Test *last* model on test set
2024-05-01 11:40:21   Ranking results: msls_val R@1: 0.6176, R@5: 0.7500, R@10: 0.7946, R@15: 0.8176, R@20: 0.8351, R@50: 0.8784, R@100: 0.9135
2024-05-01 11:46:41   Ranking results: tokyo247 R@1: 0.4870, R@5: 0.6241, R@10: 0.6903, R@15: 0.7305, R@20: 0.7518, R@50: 0.8109, R@100: 0.8511
2024-05-01 11:46:45   Ranking results: SPED R@1: 0.6606, R@5: 0.7825, R@10: 0.8270, R@15: 0.8517, R@20: 0.8748, R@50: 0.9275, R@100: 0.9638
2024-05-01 11:47:42   Ranking results: nordland R@1: 0.1167, R@5: 0.2199, R@10: 0.2656, R@15: 0.3000, R@20: 0.3217, R@50: 0.4029, R@100: 0.4819
2024-05-01 11:48:21   Ranking results: pitts30k_val R@1: 0.8370, R@5: 0.9464, R@10: 0.9695, R@15: 0.9763, R@20: 0.9803, R@50: 0.9911, R@100: 0.9953
2024-05-01 11:48:58   Ranking results: pitts30k_test R@1: 0.8217, R@5: 0.9241, R@10: 0.9484, R@15: 0.9585, R@20: 0.9642, R@50: 0.9778, R@100: 0.9843
2024-05-01 11:52:50   Ranking results: pitts250k_test R@1: 0.8256, R@5: 0.9319, R@10: 0.9525, R@15: 0.9615, R@20: 0.9675, R@50: 0.9796, R@100: 0.9877
2024-05-01 11:56:18   Ranking results: pitts250k_val R@1: 0.8148, R@5: 0.9205, R@10: 0.9414, R@15: 0.9502, R@20: 0.9556, R@50: 0.9719, R@100: 0.9809
