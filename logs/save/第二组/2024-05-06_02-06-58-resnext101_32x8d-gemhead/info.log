2024-05-06 02:06:58   Arguments: Namespace(aggregator_name='gemhead', backbone_name='resnext101_32x8d', device='cuda', dim=2048, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-06_02-06-58-resnext101_32x8d-gemhead', seed=0, train_batch_size=80, val_set_names=['msls_val'])
2024-05-06 02:06:58   The outputs are being saved in logs/2024-05-06_02-06-58-resnext101_32x8d-gemhead
2024-05-06 02:06:58   validation dataset names:['msls_val']
2024-05-06 02:06:58   Using 2 GPUs and 64 CPUs
2024-05-06 02:07:02   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-06 02:07:02   Start training epoch: 00
2024-05-06 02:40:35   Finished epoch 00 in 0:33:32, average epoch loss = 0.7449
2024-05-06 02:41:25   Ranking results: msls_val R@1: 0.7149, R@5: 0.8257, R@10: 0.8527, R@15: 0.8689, R@20: 0.8757, R@50: 0.9095, R@100: 0.9270
2024-05-06 02:41:27   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.7149
2024-05-06 02:41:27   Start training epoch: 01
2024-05-06 03:14:57   Finished epoch 01 in 0:33:29, average epoch loss = 0.5348
2024-05-06 03:15:46   Ranking results: msls_val R@1: 0.7581, R@5: 0.8459, R@10: 0.8676, R@15: 0.8878, R@20: 0.8919, R@50: 0.9149, R@100: 0.9392
2024-05-06 03:15:53   Improved: previous msls-val best R@1 = 0.7149, current R@1 = 0.7581
2024-05-06 03:15:53   Start training epoch: 02
2024-05-06 03:49:22   Finished epoch 02 in 0:33:28, average epoch loss = 0.4538
2024-05-06 03:50:10   Ranking results: msls_val R@1: 0.7784, R@5: 0.8527, R@10: 0.8784, R@15: 0.8919, R@20: 0.9014, R@50: 0.9284, R@100: 0.9419
2024-05-06 03:50:17   Improved: previous msls-val best R@1 = 0.7581, current R@1 = 0.7784
2024-05-06 03:50:17   Start training epoch: 03
2024-05-06 04:23:29   Finished epoch 03 in 0:33:12, average epoch loss = 0.3507
2024-05-06 04:24:18   Ranking results: msls_val R@1: 0.7865, R@5: 0.8527, R@10: 0.8865, R@15: 0.9014, R@20: 0.9095, R@50: 0.9311, R@100: 0.9405
2024-05-06 04:24:24   Improved: previous msls-val best R@1 = 0.7784, current R@1 = 0.7865
2024-05-06 04:24:24   Start training epoch: 04
2024-05-06 04:57:36   Finished epoch 04 in 0:33:12, average epoch loss = 0.3117
2024-05-06 04:58:24   Ranking results: msls_val R@1: 0.7797, R@5: 0.8703, R@10: 0.8905, R@15: 0.9000, R@20: 0.9027, R@50: 0.9284, R@100: 0.9432
2024-05-06 04:58:27   Not improved: 1 / 3: msls-val best R@1 = 0.7865, current R@1 = 0.7797
2024-05-06 04:58:27   Start training epoch: 05
2024-05-06 05:31:36   Finished epoch 05 in 0:33:08, average epoch loss = 0.2828
2024-05-06 05:32:24   Ranking results: msls_val R@1: 0.7851, R@5: 0.8635, R@10: 0.8851, R@15: 0.8986, R@20: 0.9095, R@50: 0.9284, R@100: 0.9405
2024-05-06 05:32:27   Not improved: 2 / 3: msls-val best R@1 = 0.7865, current R@1 = 0.7851
2024-05-06 05:32:27   Start training epoch: 06
2024-05-06 06:05:37   Finished epoch 06 in 0:33:09, average epoch loss = 0.2385
2024-05-06 06:06:25   Ranking results: msls_val R@1: 0.7946, R@5: 0.8676, R@10: 0.8919, R@15: 0.9054, R@20: 0.9081, R@50: 0.9257, R@100: 0.9405
2024-05-06 06:06:31   Improved: previous msls-val best R@1 = 0.7865, current R@1 = 0.7946
2024-05-06 06:06:31   Start training epoch: 07
2024-05-06 06:39:43   Finished epoch 07 in 0:33:12, average epoch loss = 0.2143
2024-05-06 06:40:32   Ranking results: msls_val R@1: 0.7851, R@5: 0.8581, R@10: 0.8905, R@15: 0.8986, R@20: 0.9068, R@50: 0.9257, R@100: 0.9351
2024-05-06 06:40:35   Not improved: 1 / 3: msls-val best R@1 = 0.7946, current R@1 = 0.7851
2024-05-06 06:40:35   Start training epoch: 08
2024-05-06 07:13:49   Finished epoch 08 in 0:33:14, average epoch loss = 0.2009
2024-05-06 07:14:37   Ranking results: msls_val R@1: 0.7878, R@5: 0.8703, R@10: 0.8892, R@15: 0.9000, R@20: 0.9108, R@50: 0.9270, R@100: 0.9432
2024-05-06 07:14:40   Not improved: 2 / 3: msls-val best R@1 = 0.7946, current R@1 = 0.7878
2024-05-06 07:14:40   Start training epoch: 09
2024-05-06 07:47:57   Finished epoch 09 in 0:33:17, average epoch loss = 0.1767
2024-05-06 07:48:46   Ranking results: msls_val R@1: 0.7878, R@5: 0.8676, R@10: 0.8892, R@15: 0.9054, R@20: 0.9095, R@50: 0.9203, R@100: 0.9324
2024-05-06 07:48:49   Not improved: 3 / 3: msls-val best R@1 = 0.7946, current R@1 = 0.7878
2024-05-06 07:48:49   Performance did not improve for 3 epochs. Stop training.
2024-05-06 07:48:49   Best  msls-val best R@1 = 0.7946
2024-05-06 07:48:49   Trained for 10 epochs, in total in 5:41:51
2024-05-06 07:48:49   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-06 07:48:49   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-06 07:48:49   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-06 07:48:49   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-06 07:48:49   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-06 07:48:49   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-06 07:48:50   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-06 07:48:50   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-06 07:48:50   Test *best* model on test set
2024-05-06 07:49:39   Ranking results: msls_val R@1: 0.7946, R@5: 0.8676, R@10: 0.8919, R@15: 0.9054, R@20: 0.9081, R@50: 0.9257, R@100: 0.9405
2024-05-06 07:55:52   Ranking results: tokyo247 R@1: 0.4681, R@5: 0.5508, R@10: 0.6099, R@15: 0.6359, R@20: 0.6548, R@50: 0.7163, R@100: 0.7565
2024-05-06 07:55:57   Ranking results: SPED R@1: 0.7414, R@5: 0.8567, R@10: 0.8896, R@15: 0.9094, R@20: 0.9160, R@50: 0.9539, R@100: 0.9753
2024-05-06 07:57:22   Ranking results: nordland R@1: 0.2851, R@5: 0.4514, R@10: 0.5246, R@15: 0.5678, R@20: 0.6014, R@50: 0.7109, R@100: 0.7830
2024-05-06 07:58:19   Ranking results: pitts30k_val R@1: 0.9009, R@5: 0.9599, R@10: 0.9723, R@15: 0.9786, R@20: 0.9821, R@50: 0.9904, R@100: 0.9942
2024-05-06 07:59:12   Ranking results: pitts30k_test R@1: 0.8859, R@5: 0.9325, R@10: 0.9444, R@15: 0.9498, R@20: 0.9544, R@50: 0.9679, R@100: 0.9774
2024-05-06 08:06:14   Ranking results: pitts250k_test R@1: 0.8890, R@5: 0.9371, R@10: 0.9472, R@15: 0.9518, R@20: 0.9559, R@50: 0.9650, R@100: 0.9720
2024-05-06 08:10:51   Ranking results: pitts250k_val R@1: 0.8688, R@5: 0.9157, R@10: 0.9259, R@15: 0.9307, R@20: 0.9339, R@50: 0.9456, R@100: 0.9556
2024-05-06 08:10:51   Test *last* model on test set
2024-05-06 08:11:40   Ranking results: msls_val R@1: 0.7878, R@5: 0.8676, R@10: 0.8892, R@15: 0.9054, R@20: 0.9095, R@50: 0.9203, R@100: 0.9324
2024-05-06 08:17:47   Ranking results: tokyo247 R@1: 0.4255, R@5: 0.5296, R@10: 0.5721, R@15: 0.6028, R@20: 0.6194, R@50: 0.6809, R@100: 0.7518
2024-05-06 08:17:52   Ranking results: SPED R@1: 0.7282, R@5: 0.8468, R@10: 0.8830, R@15: 0.8979, R@20: 0.9044, R@50: 0.9423, R@100: 0.9687
2024-05-06 08:19:11   Ranking results: nordland R@1: 0.2808, R@5: 0.4482, R@10: 0.5268, R@15: 0.5696, R@20: 0.6033, R@50: 0.7170, R@100: 0.7808
2024-05-06 08:20:04   Ranking results: pitts30k_val R@1: 0.8968, R@5: 0.9608, R@10: 0.9733, R@15: 0.9795, R@20: 0.9830, R@50: 0.9913, R@100: 0.9959
2024-05-06 08:20:53   Ranking results: pitts30k_test R@1: 0.8766, R@5: 0.9293, R@10: 0.9447, R@15: 0.9520, R@20: 0.9558, R@50: 0.9689, R@100: 0.9784
2024-05-06 08:25:55   Ranking results: pitts250k_test R@1: 0.8839, R@5: 0.9336, R@10: 0.9454, R@15: 0.9506, R@20: 0.9546, R@50: 0.9639, R@100: 0.9704
2024-05-06 08:30:32   Ranking results: pitts250k_val R@1: 0.8532, R@5: 0.9031, R@10: 0.9157, R@15: 0.9219, R@20: 0.9248, R@50: 0.9398, R@100: 0.9531
