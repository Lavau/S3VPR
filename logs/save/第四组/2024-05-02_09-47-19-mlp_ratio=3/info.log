2024-05-02 09:47:19   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=3.0, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-02_09-47-19', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-02 09:47:19   The outputs are being saved in logs/2024-05-02_09-47-19
2024-05-02 09:47:19   validation dataset names:['msls_val']
2024-05-02 09:47:19   Using 2 GPUs and 64 CPUs
2024-05-02 09:47:19   using MLP layer as FFN
2024-05-02 09:47:23   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 09:47:23   Start training epoch: 00
2024-05-02 10:07:50   Finished epoch 00 in 0:20:27, average epoch loss = 0.7860
2024-05-02 10:08:50   Ranking results: msls_val R@1: 0.8541, R@5: 0.9243, R@10: 0.9338, R@15: 0.9446, R@20: 0.9486, R@50: 0.9622, R@100: 0.9730
2024-05-02 10:08:53   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8541
2024-05-02 10:08:53   Start training epoch: 01
2024-05-02 10:29:18   Finished epoch 01 in 0:20:25, average epoch loss = 0.4471
2024-05-02 10:30:18   Ranking results: msls_val R@1: 0.8608, R@5: 0.9405, R@10: 0.9541, R@15: 0.9595, R@20: 0.9595, R@50: 0.9689, R@100: 0.9730
2024-05-02 10:30:25   Improved: previous msls-val best R@1 = 0.8541, current R@1 = 0.8608
2024-05-02 10:30:25   Start training epoch: 02
2024-05-02 10:50:50   Finished epoch 02 in 0:20:24, average epoch loss = 0.3847
2024-05-02 10:51:50   Ranking results: msls_val R@1: 0.8622, R@5: 0.9324, R@10: 0.9459, R@15: 0.9514, R@20: 0.9554, R@50: 0.9689, R@100: 0.9743
2024-05-02 10:51:57   Improved: previous msls-val best R@1 = 0.8608, current R@1 = 0.8622
2024-05-02 10:51:57   Start training epoch: 03
2024-05-02 11:12:24   Finished epoch 03 in 0:20:26, average epoch loss = 0.3343
2024-05-02 11:13:23   Ranking results: msls_val R@1: 0.8784, R@5: 0.9432, R@10: 0.9554, R@15: 0.9608, R@20: 0.9622, R@50: 0.9703, R@100: 0.9797
2024-05-02 11:13:30   Improved: previous msls-val best R@1 = 0.8622, current R@1 = 0.8784
2024-05-02 11:13:30   Start training epoch: 04
2024-05-02 11:33:56   Finished epoch 04 in 0:20:25, average epoch loss = 0.3125
2024-05-02 11:34:56   Ranking results: msls_val R@1: 0.8784, R@5: 0.9419, R@10: 0.9514, R@15: 0.9608, R@20: 0.9622, R@50: 0.9689, R@100: 0.9797
2024-05-02 11:35:00   Not improved: 1 / 3: msls-val best R@1 = 0.8784, current R@1 = 0.8784
2024-05-02 11:35:00   Start training epoch: 05
2024-05-02 11:55:26   Finished epoch 05 in 0:20:26, average epoch loss = 0.2932
2024-05-02 11:56:26   Ranking results: msls_val R@1: 0.8878, R@5: 0.9473, R@10: 0.9622, R@15: 0.9635, R@20: 0.9662, R@50: 0.9730, R@100: 0.9770
2024-05-02 11:56:33   Improved: previous msls-val best R@1 = 0.8784, current R@1 = 0.8878
2024-05-02 11:56:33   Start training epoch: 06
2024-05-02 12:16:51   Finished epoch 06 in 0:20:17, average epoch loss = 0.2671
2024-05-02 12:17:50   Ranking results: msls_val R@1: 0.8838, R@5: 0.9432, R@10: 0.9541, R@15: 0.9608, R@20: 0.9622, R@50: 0.9676, R@100: 0.9757
2024-05-02 12:17:54   Not improved: 1 / 3: msls-val best R@1 = 0.8878, current R@1 = 0.8838
2024-05-02 12:17:54   Start training epoch: 07
2024-05-02 12:38:13   Finished epoch 07 in 0:20:18, average epoch loss = 0.2524
2024-05-02 12:39:12   Ranking results: msls_val R@1: 0.8892, R@5: 0.9486, R@10: 0.9595, R@15: 0.9662, R@20: 0.9689, R@50: 0.9730, R@100: 0.9757
2024-05-02 12:39:19   Improved: previous msls-val best R@1 = 0.8878, current R@1 = 0.8892
2024-05-02 12:39:19   Start training epoch: 08
2024-05-02 12:59:36   Finished epoch 08 in 0:20:17, average epoch loss = 0.2459
2024-05-02 13:00:36   Ranking results: msls_val R@1: 0.9027, R@5: 0.9473, R@10: 0.9527, R@15: 0.9608, R@20: 0.9622, R@50: 0.9730, R@100: 0.9743
2024-05-02 13:00:43   Improved: previous msls-val best R@1 = 0.8892, current R@1 = 0.9027
2024-05-02 13:00:43   Start training epoch: 09
2024-05-02 13:21:05   Finished epoch 09 in 0:20:21, average epoch loss = 0.2327
2024-05-02 13:22:05   Ranking results: msls_val R@1: 0.8946, R@5: 0.9459, R@10: 0.9568, R@15: 0.9649, R@20: 0.9676, R@50: 0.9730, R@100: 0.9757
2024-05-02 13:22:09   Not improved: 1 / 3: msls-val best R@1 = 0.9027, current R@1 = 0.8946
2024-05-02 13:22:09   Start training epoch: 10
2024-05-02 13:42:29   Finished epoch 10 in 0:20:20, average epoch loss = 0.2254
2024-05-02 13:43:29   Ranking results: msls_val R@1: 0.9027, R@5: 0.9473, R@10: 0.9608, R@15: 0.9635, R@20: 0.9649, R@50: 0.9703, R@100: 0.9743
2024-05-02 13:43:33   Not improved: 2 / 3: msls-val best R@1 = 0.9027, current R@1 = 0.9027
2024-05-02 13:43:33   Start training epoch: 11
2024-05-02 14:03:52   Finished epoch 11 in 0:20:19, average epoch loss = 0.2189
2024-05-02 14:04:52   Ranking results: msls_val R@1: 0.8959, R@5: 0.9446, R@10: 0.9554, R@15: 0.9649, R@20: 0.9689, R@50: 0.9703, R@100: 0.9743
2024-05-02 14:04:56   Not improved: 3 / 3: msls-val best R@1 = 0.9027, current R@1 = 0.8959
2024-05-02 14:04:56   Performance did not improve for 3 epochs. Stop training.
2024-05-02 14:04:56   Best  msls-val best R@1 = 0.9027
2024-05-02 14:04:56   Trained for 12 epochs, in total in 4:17:37
2024-05-02 14:04:56   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 14:04:56   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-02 14:04:56   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-02 14:04:56   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-02 14:04:56   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-02 14:04:56   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-02 14:04:57   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-02 14:04:57   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-02 14:04:57   Test *best* model on test set
2024-05-02 14:05:57   Ranking results: msls_val R@1: 0.9027, R@5: 0.9473, R@10: 0.9527, R@15: 0.9608, R@20: 0.9622, R@50: 0.9730, R@100: 0.9743
2024-05-02 14:12:13   Ranking results: tokyo247 R@1: 0.8392, R@5: 0.9007, R@10: 0.9220, R@15: 0.9220, R@20: 0.9362, R@50: 0.9551, R@100: 0.9669
2024-05-02 14:12:18   Ranking results: SPED R@1: 0.8814, R@5: 0.9407, R@10: 0.9522, R@15: 0.9638, R@20: 0.9703, R@50: 0.9769, R@100: 0.9835
2024-05-02 14:13:56   Ranking results: nordland R@1: 0.5395, R@5: 0.7348, R@10: 0.7978, R@15: 0.8268, R@20: 0.8493, R@50: 0.9134, R@100: 0.9413
2024-05-02 14:14:58   Ranking results: pitts30k_val R@1: 0.9415, R@5: 0.9866, R@10: 0.9934, R@15: 0.9951, R@20: 0.9968, R@50: 0.9987, R@100: 0.9999
2024-05-02 14:15:58   Ranking results: pitts30k_test R@1: 0.9174, R@5: 0.9547, R@10: 0.9665, R@15: 0.9715, R@20: 0.9751, R@50: 0.9824, R@100: 0.9888
2024-05-02 14:21:58   Ranking results: pitts250k_test R@1: 0.9467, R@5: 0.9808, R@10: 0.9884, R@15: 0.9930, R@20: 0.9940, R@50: 0.9967, R@100: 0.9977
2024-05-02 14:27:25   Ranking results: pitts250k_val R@1: 0.9373, R@5: 0.9841, R@10: 0.9912, R@15: 0.9933, R@20: 0.9949, R@50: 0.9975, R@100: 0.9989
2024-05-02 14:27:25   Test *last* model on test set
2024-05-02 14:28:25   Ranking results: msls_val R@1: 0.8959, R@5: 0.9446, R@10: 0.9554, R@15: 0.9649, R@20: 0.9689, R@50: 0.9703, R@100: 0.9743
2024-05-02 14:34:47   Ranking results: tokyo247 R@1: 0.8392, R@5: 0.8913, R@10: 0.9173, R@15: 0.9291, R@20: 0.9338, R@50: 0.9527, R@100: 0.9645
2024-05-02 14:34:52   Ranking results: SPED R@1: 0.8863, R@5: 0.9407, R@10: 0.9456, R@15: 0.9555, R@20: 0.9588, R@50: 0.9786, R@100: 0.9852
2024-05-02 14:36:30   Ranking results: nordland R@1: 0.5446, R@5: 0.7344, R@10: 0.7946, R@15: 0.8228, R@20: 0.8413, R@50: 0.9022, R@100: 0.9366
2024-05-02 14:37:32   Ranking results: pitts30k_val R@1: 0.9431, R@5: 0.9892, R@10: 0.9957, R@15: 0.9970, R@20: 0.9975, R@50: 0.9993, R@100: 0.9996
2024-05-02 14:38:32   Ranking results: pitts30k_test R@1: 0.9187, R@5: 0.9558, R@10: 0.9655, R@15: 0.9708, R@20: 0.9746, R@50: 0.9831, R@100: 0.9886
2024-05-02 14:44:30   Ranking results: pitts250k_test R@1: 0.9471, R@5: 0.9816, R@10: 0.9894, R@15: 0.9926, R@20: 0.9941, R@50: 0.9964, R@100: 0.9981
2024-05-02 14:49:56   Ranking results: pitts250k_val R@1: 0.9402, R@5: 0.9878, R@10: 0.9932, R@15: 0.9951, R@20: 0.9962, R@50: 0.9986, R@100: 0.9996
