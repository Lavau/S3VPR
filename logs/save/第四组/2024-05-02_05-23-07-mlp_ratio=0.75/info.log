2024-05-02 05:23:07   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-02_05-23-07', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-02 05:23:07   The outputs are being saved in logs/2024-05-02_05-23-07
2024-05-02 05:23:07   validation dataset names:['msls_val']
2024-05-02 05:23:07   Using 2 GPUs and 64 CPUs
2024-05-02 05:23:07   using MLP layer as FFN
2024-05-02 05:23:11   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 05:23:11   Start training epoch: 00
2024-05-02 05:42:56   Finished epoch 00 in 0:19:44, average epoch loss = 0.7897
2024-05-02 05:43:55   Ranking results: msls_val R@1: 0.8486, R@5: 0.9216, R@10: 0.9405, R@15: 0.9568, R@20: 0.9581, R@50: 0.9622, R@100: 0.9689
2024-05-02 05:43:57   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8486
2024-05-02 05:43:57   Start training epoch: 01
2024-05-02 06:03:37   Finished epoch 01 in 0:19:39, average epoch loss = 0.4315
2024-05-02 06:04:36   Ranking results: msls_val R@1: 0.8757, R@5: 0.9338, R@10: 0.9500, R@15: 0.9554, R@20: 0.9595, R@50: 0.9676, R@100: 0.9703
2024-05-02 06:04:43   Improved: previous msls-val best R@1 = 0.8486, current R@1 = 0.8757
2024-05-02 06:04:43   Start training epoch: 02
2024-05-02 06:24:22   Finished epoch 02 in 0:19:39, average epoch loss = 0.3678
2024-05-02 06:25:21   Ranking results: msls_val R@1: 0.8797, R@5: 0.9365, R@10: 0.9432, R@15: 0.9514, R@20: 0.9581, R@50: 0.9703, R@100: 0.9770
2024-05-02 06:25:28   Improved: previous msls-val best R@1 = 0.8757, current R@1 = 0.8797
2024-05-02 06:25:28   Start training epoch: 03
2024-05-02 06:45:06   Finished epoch 03 in 0:19:38, average epoch loss = 0.3154
2024-05-02 06:46:05   Ranking results: msls_val R@1: 0.8865, R@5: 0.9392, R@10: 0.9568, R@15: 0.9595, R@20: 0.9635, R@50: 0.9730, R@100: 0.9743
2024-05-02 06:46:13   Improved: previous msls-val best R@1 = 0.8797, current R@1 = 0.8865
2024-05-02 06:46:13   Start training epoch: 04
2024-05-02 07:05:52   Finished epoch 04 in 0:19:39, average epoch loss = 0.2877
2024-05-02 07:06:50   Ranking results: msls_val R@1: 0.8851, R@5: 0.9473, R@10: 0.9541, R@15: 0.9568, R@20: 0.9622, R@50: 0.9676, R@100: 0.9757
2024-05-02 07:06:54   Not improved: 1 / 3: msls-val best R@1 = 0.8865, current R@1 = 0.8851
2024-05-02 07:06:54   Start training epoch: 05
2024-05-02 07:26:34   Finished epoch 05 in 0:19:39, average epoch loss = 0.2725
2024-05-02 07:27:32   Ranking results: msls_val R@1: 0.8905, R@5: 0.9446, R@10: 0.9568, R@15: 0.9608, R@20: 0.9622, R@50: 0.9676, R@100: 0.9730
2024-05-02 07:27:40   Improved: previous msls-val best R@1 = 0.8865, current R@1 = 0.8905
2024-05-02 07:27:40   Start training epoch: 06
2024-05-02 07:47:19   Finished epoch 06 in 0:19:38, average epoch loss = 0.2472
2024-05-02 07:48:17   Ranking results: msls_val R@1: 0.9014, R@5: 0.9541, R@10: 0.9622, R@15: 0.9649, R@20: 0.9676, R@50: 0.9689, R@100: 0.9757
2024-05-02 07:48:26   Improved: previous msls-val best R@1 = 0.8905, current R@1 = 0.9014
2024-05-02 07:48:26   Start training epoch: 07
2024-05-02 08:08:07   Finished epoch 07 in 0:19:40, average epoch loss = 0.2350
2024-05-02 08:09:05   Ranking results: msls_val R@1: 0.8946, R@5: 0.9541, R@10: 0.9635, R@15: 0.9662, R@20: 0.9676, R@50: 0.9703, R@100: 0.9730
2024-05-02 08:09:09   Not improved: 1 / 3: msls-val best R@1 = 0.9014, current R@1 = 0.8946
2024-05-02 08:09:09   Start training epoch: 08
2024-05-02 08:28:48   Finished epoch 08 in 0:19:39, average epoch loss = 0.2231
2024-05-02 08:29:47   Ranking results: msls_val R@1: 0.8973, R@5: 0.9514, R@10: 0.9608, R@15: 0.9662, R@20: 0.9703, R@50: 0.9730, R@100: 0.9743
2024-05-02 08:29:51   Not improved: 2 / 3: msls-val best R@1 = 0.9014, current R@1 = 0.8973
2024-05-02 08:29:51   Start training epoch: 09
2024-05-02 08:49:29   Finished epoch 09 in 0:19:38, average epoch loss = 0.2119
2024-05-02 08:50:28   Ranking results: msls_val R@1: 0.9000, R@5: 0.9527, R@10: 0.9635, R@15: 0.9662, R@20: 0.9662, R@50: 0.9730, R@100: 0.9743
2024-05-02 08:50:31   Not improved: 3 / 3: msls-val best R@1 = 0.9014, current R@1 = 0.9000
2024-05-02 08:50:31   Performance did not improve for 3 epochs. Stop training.
2024-05-02 08:50:31   Best  msls-val best R@1 = 0.9014
2024-05-02 08:50:31   Trained for 10 epochs, in total in 3:27:24
2024-05-02 08:50:31   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 08:50:31   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-02 08:50:31   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-02 08:50:31   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-02 08:50:31   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-02 08:50:32   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-02 08:50:32   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-02 08:50:33   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-02 08:50:33   Test *best* model on test set
2024-05-02 08:51:31   Ranking results: msls_val R@1: 0.9014, R@5: 0.9541, R@10: 0.9622, R@15: 0.9649, R@20: 0.9676, R@50: 0.9689, R@100: 0.9757
2024-05-02 08:57:47   Ranking results: tokyo247 R@1: 0.8298, R@5: 0.9007, R@10: 0.9196, R@15: 0.9385, R@20: 0.9433, R@50: 0.9527, R@100: 0.9598
2024-05-02 08:57:53   Ranking results: SPED R@1: 0.8715, R@5: 0.9292, R@10: 0.9423, R@15: 0.9489, R@20: 0.9605, R@50: 0.9802, R@100: 0.9868
2024-05-02 08:59:28   Ranking results: nordland R@1: 0.5123, R@5: 0.6870, R@10: 0.7464, R@15: 0.7848, R@20: 0.8051, R@50: 0.8707, R@100: 0.9018
2024-05-02 09:00:29   Ranking results: pitts30k_val R@1: 0.9411, R@5: 0.9866, R@10: 0.9925, R@15: 0.9949, R@20: 0.9965, R@50: 0.9989, R@100: 0.9999
2024-05-02 09:01:27   Ranking results: pitts30k_test R@1: 0.9123, R@5: 0.9520, R@10: 0.9649, R@15: 0.9730, R@20: 0.9764, R@50: 0.9839, R@100: 0.9883
2024-05-02 09:07:16   Ranking results: pitts250k_test R@1: 0.9455, R@5: 0.9789, R@10: 0.9865, R@15: 0.9903, R@20: 0.9923, R@50: 0.9963, R@100: 0.9976
2024-05-02 09:12:36   Ranking results: pitts250k_val R@1: 0.9370, R@5: 0.9834, R@10: 0.9903, R@15: 0.9924, R@20: 0.9938, R@50: 0.9974, R@100: 0.9987
2024-05-02 09:12:36   Test *last* model on test set
2024-05-02 09:13:33   Ranking results: msls_val R@1: 0.9000, R@5: 0.9527, R@10: 0.9635, R@15: 0.9662, R@20: 0.9662, R@50: 0.9730, R@100: 0.9743
2024-05-02 09:19:47   Ranking results: tokyo247 R@1: 0.8274, R@5: 0.9078, R@10: 0.9267, R@15: 0.9385, R@20: 0.9433, R@50: 0.9527, R@100: 0.9669
2024-05-02 09:19:52   Ranking results: SPED R@1: 0.8699, R@5: 0.9292, R@10: 0.9489, R@15: 0.9572, R@20: 0.9588, R@50: 0.9753, R@100: 0.9819
2024-05-02 09:21:27   Ranking results: nordland R@1: 0.5562, R@5: 0.7221, R@10: 0.7880, R@15: 0.8178, R@20: 0.8373, R@50: 0.8899, R@100: 0.9221
2024-05-02 09:22:28   Ranking results: pitts30k_val R@1: 0.9431, R@5: 0.9867, R@10: 0.9933, R@15: 0.9959, R@20: 0.9970, R@50: 0.9991, R@100: 0.9997
2024-05-02 09:23:26   Ranking results: pitts30k_test R@1: 0.9164, R@5: 0.9531, R@10: 0.9665, R@15: 0.9727, R@20: 0.9761, R@50: 0.9849, R@100: 0.9884
2024-05-02 09:29:18   Ranking results: pitts250k_test R@1: 0.9478, R@5: 0.9804, R@10: 0.9874, R@15: 0.9902, R@20: 0.9920, R@50: 0.9961, R@100: 0.9979
2024-05-02 09:34:35   Ranking results: pitts250k_val R@1: 0.9377, R@5: 0.9846, R@10: 0.9908, R@15: 0.9930, R@20: 0.9943, R@50: 0.9975, R@100: 0.9991
