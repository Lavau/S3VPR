2024-05-02 08:30:14   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=3, lr=0.0001, mlp_ratio=2.0, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-02_08-30-14', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-02 08:30:14   The outputs are being saved in logs/2024-05-02_08-30-14
2024-05-02 08:30:14   validation dataset names:['msls_val']
2024-05-02 08:30:14   Using 2 GPUs and 64 CPUs
2024-05-02 08:30:14   using MLP layer as FFN
2024-05-02 08:30:19   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 08:30:19   Start training epoch: 00
2024-05-02 08:50:20   Finished epoch 00 in 0:20:00, average epoch loss = 0.7674
2024-05-02 08:51:19   Ranking results: msls_val R@1: 0.8514, R@5: 0.9176, R@10: 0.9324, R@15: 0.9405, R@20: 0.9459, R@50: 0.9554, R@100: 0.9676
2024-05-02 08:51:21   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8514
2024-05-02 08:51:21   Start training epoch: 01
2024-05-02 09:11:17   Finished epoch 01 in 0:19:56, average epoch loss = 0.4296
2024-05-02 09:12:16   Ranking results: msls_val R@1: 0.8703, R@5: 0.9378, R@10: 0.9500, R@15: 0.9581, R@20: 0.9581, R@50: 0.9649, R@100: 0.9689
2024-05-02 09:12:23   Improved: previous msls-val best R@1 = 0.8514, current R@1 = 0.8703
2024-05-02 09:12:23   Start training epoch: 02
2024-05-02 09:32:20   Finished epoch 02 in 0:19:57, average epoch loss = 0.3731
2024-05-02 09:33:18   Ranking results: msls_val R@1: 0.8743, R@5: 0.9243, R@10: 0.9338, R@15: 0.9405, R@20: 0.9459, R@50: 0.9554, R@100: 0.9649
2024-05-02 09:33:26   Improved: previous msls-val best R@1 = 0.8703, current R@1 = 0.8743
2024-05-02 09:33:26   Start training epoch: 03
2024-05-02 09:53:25   Finished epoch 03 in 0:19:59, average epoch loss = 0.3208
2024-05-02 09:54:24   Ranking results: msls_val R@1: 0.8811, R@5: 0.9378, R@10: 0.9486, R@15: 0.9541, R@20: 0.9581, R@50: 0.9662, R@100: 0.9689
2024-05-02 09:54:31   Improved: previous msls-val best R@1 = 0.8743, current R@1 = 0.8811
2024-05-02 09:54:31   Start training epoch: 04
2024-05-02 10:14:27   Finished epoch 04 in 0:19:56, average epoch loss = 0.2973
2024-05-02 10:15:26   Ranking results: msls_val R@1: 0.8865, R@5: 0.9338, R@10: 0.9473, R@15: 0.9554, R@20: 0.9581, R@50: 0.9662, R@100: 0.9689
2024-05-02 10:15:33   Improved: previous msls-val best R@1 = 0.8811, current R@1 = 0.8865
2024-05-02 10:15:33   Start training epoch: 05
2024-05-02 10:35:29   Finished epoch 05 in 0:19:56, average epoch loss = 0.2816
2024-05-02 10:36:28   Ranking results: msls_val R@1: 0.8743, R@5: 0.9378, R@10: 0.9527, R@15: 0.9568, R@20: 0.9595, R@50: 0.9689, R@100: 0.9689
2024-05-02 10:36:32   Not improved: 1 / 3: msls-val best R@1 = 0.8865, current R@1 = 0.8743
2024-05-02 10:36:32   Start training epoch: 06
2024-05-02 10:56:28   Finished epoch 06 in 0:19:55, average epoch loss = 0.2578
2024-05-02 10:57:26   Ranking results: msls_val R@1: 0.8865, R@5: 0.9392, R@10: 0.9568, R@15: 0.9595, R@20: 0.9622, R@50: 0.9662, R@100: 0.9662
2024-05-02 10:57:30   Not improved: 2 / 3: msls-val best R@1 = 0.8865, current R@1 = 0.8865
2024-05-02 10:57:30   Start training epoch: 07
2024-05-02 11:17:27   Finished epoch 07 in 0:19:57, average epoch loss = 0.2450
2024-05-02 11:18:26   Ranking results: msls_val R@1: 0.8824, R@5: 0.9392, R@10: 0.9541, R@15: 0.9581, R@20: 0.9608, R@50: 0.9635, R@100: 0.9662
2024-05-02 11:18:30   Not improved: 3 / 3: msls-val best R@1 = 0.8865, current R@1 = 0.8824
2024-05-02 11:18:30   Performance did not improve for 3 epochs. Stop training.
2024-05-02 11:18:30   Best  msls-val best R@1 = 0.8865
2024-05-02 11:18:30   Trained for 08 epochs, in total in 2:48:15
2024-05-02 11:18:30   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-02 11:18:30   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-02 11:18:30   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-02 11:18:30   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-02 11:18:30   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-02 11:18:30   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-02 11:18:31   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-02 11:18:31   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-02 11:18:31   Test *best* model on test set
2024-05-02 11:19:30   Ranking results: msls_val R@1: 0.8865, R@5: 0.9338, R@10: 0.9473, R@15: 0.9554, R@20: 0.9581, R@50: 0.9662, R@100: 0.9689
2024-05-02 11:25:49   Ranking results: tokyo247 R@1: 0.8322, R@5: 0.9078, R@10: 0.9267, R@15: 0.9362, R@20: 0.9409, R@50: 0.9598, R@100: 0.9622
2024-05-02 11:25:55   Ranking results: SPED R@1: 0.8929, R@5: 0.9440, R@10: 0.9588, R@15: 0.9621, R@20: 0.9687, R@50: 0.9802, R@100: 0.9868
2024-05-02 11:27:32   Ranking results: nordland R@1: 0.5308, R@5: 0.7069, R@10: 0.7670, R@15: 0.8091, R@20: 0.8257, R@50: 0.8815, R@100: 0.9236
2024-05-02 11:28:34   Ranking results: pitts30k_val R@1: 0.9389, R@5: 0.9875, R@10: 0.9938, R@15: 0.9958, R@20: 0.9972, R@50: 0.9992, R@100: 0.9999
2024-05-02 11:29:32   Ranking results: pitts30k_test R@1: 0.9124, R@5: 0.9547, R@10: 0.9665, R@15: 0.9726, R@20: 0.9764, R@50: 0.9844, R@100: 0.9893
2024-05-02 11:35:27   Ranking results: pitts250k_test R@1: 0.9411, R@5: 0.9804, R@10: 0.9894, R@15: 0.9917, R@20: 0.9936, R@50: 0.9955, R@100: 0.9967
2024-05-02 11:40:48   Ranking results: pitts250k_val R@1: 0.9347, R@5: 0.9853, R@10: 0.9922, R@15: 0.9943, R@20: 0.9957, R@50: 0.9987, R@100: 0.9993
2024-05-02 11:40:48   Test *last* model on test set
2024-05-02 11:41:48   Ranking results: msls_val R@1: 0.8824, R@5: 0.9392, R@10: 0.9541, R@15: 0.9581, R@20: 0.9608, R@50: 0.9635, R@100: 0.9662
2024-05-02 11:48:08   Ranking results: tokyo247 R@1: 0.8322, R@5: 0.9078, R@10: 0.9267, R@15: 0.9362, R@20: 0.9433, R@50: 0.9645, R@100: 0.9716
2024-05-02 11:48:14   Ranking results: SPED R@1: 0.8764, R@5: 0.9407, R@10: 0.9456, R@15: 0.9555, R@20: 0.9671, R@50: 0.9835, R@100: 0.9918
2024-05-02 11:49:51   Ranking results: nordland R@1: 0.4996, R@5: 0.6703, R@10: 0.7333, R@15: 0.7598, R@20: 0.7870, R@50: 0.8558, R@100: 0.8996
2024-05-02 11:50:53   Ranking results: pitts30k_val R@1: 0.9406, R@5: 0.9884, R@10: 0.9947, R@15: 0.9970, R@20: 0.9982, R@50: 0.9989, R@100: 1.0000
2024-05-02 11:51:51   Ranking results: pitts30k_test R@1: 0.9167, R@5: 0.9557, R@10: 0.9689, R@15: 0.9746, R@20: 0.9771, R@50: 0.9846, R@100: 0.9902
2024-05-02 11:57:45   Ranking results: pitts250k_test R@1: 0.9472, R@5: 0.9812, R@10: 0.9896, R@15: 0.9926, R@20: 0.9941, R@50: 0.9965, R@100: 0.9973
2024-05-02 12:03:08   Ranking results: pitts250k_val R@1: 0.9394, R@5: 0.9859, R@10: 0.9926, R@15: 0.9958, R@20: 0.9966, R@50: 0.9987, R@100: 0.9992
