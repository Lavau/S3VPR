2024-05-01 14:04:59   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=5, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-01_14-04-59', seed=0, train_batch_size=90, val_set_names=['msls_val'])
2024-05-01 14:04:59   The outputs are being saved in logs/2024-05-01_14-04-59
2024-05-01 14:04:59   validation dataset names:['msls_val']
2024-05-01 14:04:59   Using 2 GPUs and 64 CPUs
2024-05-01 14:04:59   using MLP layer as FFN
2024-05-01 14:05:03   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 14:05:03   Start training epoch: 00
2024-05-01 14:28:06   Finished epoch 00 in 0:23:02, average epoch loss = 0.6612
2024-05-01 14:29:07   Ranking results: msls_val R@1: 0.8405, R@5: 0.9162, R@10: 0.9378, R@15: 0.9473, R@20: 0.9527, R@50: 0.9622, R@100: 0.9703
2024-05-01 14:29:09   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8405
2024-05-01 14:29:09   Start training epoch: 01
2024-05-01 14:52:06   Finished epoch 01 in 0:22:57, average epoch loss = 0.3794
2024-05-01 14:53:07   Ranking results: msls_val R@1: 0.8635, R@5: 0.9324, R@10: 0.9432, R@15: 0.9527, R@20: 0.9595, R@50: 0.9689, R@100: 0.9797
2024-05-01 14:53:15   Improved: previous msls-val best R@1 = 0.8405, current R@1 = 0.8635
2024-05-01 14:53:15   Start training epoch: 02
2024-05-01 15:16:12   Finished epoch 02 in 0:22:57, average epoch loss = 0.3332
2024-05-01 15:17:13   Ranking results: msls_val R@1: 0.8743, R@5: 0.9351, R@10: 0.9486, R@15: 0.9527, R@20: 0.9622, R@50: 0.9676, R@100: 0.9716
2024-05-01 15:17:21   Improved: previous msls-val best R@1 = 0.8635, current R@1 = 0.8743
2024-05-01 15:17:21   Start training epoch: 03
2024-05-01 15:40:18   Finished epoch 03 in 0:22:57, average epoch loss = 0.2789
2024-05-01 15:41:20   Ranking results: msls_val R@1: 0.8892, R@5: 0.9351, R@10: 0.9486, R@15: 0.9554, R@20: 0.9595, R@50: 0.9635, R@100: 0.9649
2024-05-01 15:41:26   Improved: previous msls-val best R@1 = 0.8743, current R@1 = 0.8892
2024-05-01 15:41:26   Start training epoch: 04
2024-05-01 16:04:24   Finished epoch 04 in 0:22:57, average epoch loss = 0.2555
2024-05-01 16:05:25   Ranking results: msls_val R@1: 0.8838, R@5: 0.9365, R@10: 0.9473, R@15: 0.9581, R@20: 0.9595, R@50: 0.9689, R@100: 0.9703
2024-05-01 16:05:28   Not improved: 1 / 3: msls-val best R@1 = 0.8892, current R@1 = 0.8838
2024-05-01 16:05:28   Start training epoch: 05
2024-05-01 16:28:26   Finished epoch 05 in 0:22:57, average epoch loss = 0.2420
2024-05-01 16:29:27   Ranking results: msls_val R@1: 0.8878, R@5: 0.9351, R@10: 0.9500, R@15: 0.9581, R@20: 0.9622, R@50: 0.9689, R@100: 0.9703
2024-05-01 16:29:30   Not improved: 2 / 3: msls-val best R@1 = 0.8892, current R@1 = 0.8878
2024-05-01 16:29:30   Start training epoch: 06
2024-05-01 16:52:28   Finished epoch 06 in 0:22:57, average epoch loss = 0.2151
2024-05-01 16:53:29   Ranking results: msls_val R@1: 0.8743, R@5: 0.9378, R@10: 0.9527, R@15: 0.9554, R@20: 0.9568, R@50: 0.9676, R@100: 0.9689
2024-05-01 16:53:33   Not improved: 3 / 3: msls-val best R@1 = 0.8892, current R@1 = 0.8743
2024-05-01 16:53:33   Performance did not improve for 3 epochs. Stop training.
2024-05-01 16:53:33   Best  msls-val best R@1 = 0.8892
2024-05-01 16:53:33   Trained for 07 epochs, in total in 2:48:33
2024-05-01 16:53:33   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 16:53:33   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-01 16:53:33   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-01 16:53:33   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-01 16:53:33   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-01 16:53:33   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-01 16:53:33   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-01 16:53:34   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-01 16:53:34   Test *best* model on test set
2024-05-01 16:54:35   Ranking results: msls_val R@1: 0.8892, R@5: 0.9351, R@10: 0.9486, R@15: 0.9554, R@20: 0.9595, R@50: 0.9635, R@100: 0.9649
2024-05-01 17:00:47   Ranking results: tokyo247 R@1: 0.7943, R@5: 0.8913, R@10: 0.9267, R@15: 0.9314, R@20: 0.9338, R@50: 0.9480, R@100: 0.9622
2024-05-01 17:00:52   Ranking results: SPED R@1: 0.8748, R@5: 0.9456, R@10: 0.9522, R@15: 0.9555, R@20: 0.9621, R@50: 0.9835, R@100: 0.9901
2024-05-01 17:02:32   Ranking results: nordland R@1: 0.5413, R@5: 0.7123, R@10: 0.7699, R@15: 0.7964, R@20: 0.8123, R@50: 0.8725, R@100: 0.9156
2024-05-01 17:03:36   Ranking results: pitts30k_val R@1: 0.9397, R@5: 0.9867, R@10: 0.9929, R@15: 0.9950, R@20: 0.9968, R@50: 0.9993, R@100: 0.9996
2024-05-01 17:04:36   Ranking results: pitts30k_test R@1: 0.9131, R@5: 0.9561, R@10: 0.9670, R@15: 0.9726, R@20: 0.9752, R@50: 0.9842, R@100: 0.9887
2024-05-01 17:10:38   Ranking results: pitts250k_test R@1: 0.9402, R@5: 0.9801, R@10: 0.9879, R@15: 0.9911, R@20: 0.9923, R@50: 0.9961, R@100: 0.9972
2024-05-01 17:16:08   Ranking results: pitts250k_val R@1: 0.9357, R@5: 0.9837, R@10: 0.9892, R@15: 0.9919, R@20: 0.9934, R@50: 0.9980, R@100: 0.9989
2024-05-01 17:16:08   Test *last* model on test set
2024-05-01 17:17:10   Ranking results: msls_val R@1: 0.8743, R@5: 0.9378, R@10: 0.9527, R@15: 0.9554, R@20: 0.9568, R@50: 0.9676, R@100: 0.9689
2024-05-01 17:23:24   Ranking results: tokyo247 R@1: 0.8298, R@5: 0.9054, R@10: 0.9149, R@15: 0.9196, R@20: 0.9243, R@50: 0.9504, R@100: 0.9669
2024-05-01 17:23:29   Ranking results: SPED R@1: 0.8764, R@5: 0.9407, R@10: 0.9522, R@15: 0.9588, R@20: 0.9621, R@50: 0.9802, R@100: 0.9885
2024-05-01 17:25:10   Ranking results: nordland R@1: 0.5536, R@5: 0.7304, R@10: 0.7880, R@15: 0.8174, R@20: 0.8391, R@50: 0.8906, R@100: 0.9257
2024-05-01 17:26:13   Ranking results: pitts30k_val R@1: 0.9458, R@5: 0.9880, R@10: 0.9933, R@15: 0.9965, R@20: 0.9978, R@50: 0.9997, R@100: 1.0000
2024-05-01 17:27:14   Ranking results: pitts30k_test R@1: 0.9129, R@5: 0.9554, R@10: 0.9680, R@15: 0.9736, R@20: 0.9767, R@50: 0.9856, R@100: 0.9906
2024-05-01 17:33:17   Ranking results: pitts250k_test R@1: 0.9429, R@5: 0.9806, R@10: 0.9894, R@15: 0.9925, R@20: 0.9935, R@50: 0.9970, R@100: 0.9981
2024-05-01 17:38:49   Ranking results: pitts250k_val R@1: 0.9432, R@5: 0.9861, R@10: 0.9915, R@15: 0.9940, R@20: 0.9954, R@50: 0.9988, R@100: 0.9997
