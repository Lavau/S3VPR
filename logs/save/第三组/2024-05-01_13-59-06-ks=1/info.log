2024-05-01 13:59:06   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=1, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-01_13-59-06', seed=0, train_batch_size=160, val_set_names=['msls_val'])
2024-05-01 13:59:06   The outputs are being saved in logs/2024-05-01_13-59-06
2024-05-01 13:59:06   validation dataset names:['msls_val']
2024-05-01 13:59:06   Using 2 GPUs and 64 CPUs
2024-05-01 13:59:06   using MLP layer as FFN
2024-05-01 13:59:11   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 13:59:11   Start training epoch: 00
2024-05-01 14:17:27   Finished epoch 00 in 0:18:15, average epoch loss = 0.7876
2024-05-01 14:18:23   Ranking results: msls_val R@1: 0.8378, R@5: 0.9108, R@10: 0.9351, R@15: 0.9486, R@20: 0.9541, R@50: 0.9649, R@100: 0.9703
2024-05-01 14:18:25   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8378
2024-05-01 14:18:25   Start training epoch: 01
2024-05-01 14:36:39   Finished epoch 01 in 0:18:13, average epoch loss = 0.4301
2024-05-01 14:37:35   Ranking results: msls_val R@1: 0.8676, R@5: 0.9297, R@10: 0.9459, R@15: 0.9595, R@20: 0.9622, R@50: 0.9676, R@100: 0.9689
2024-05-01 14:37:42   Improved: previous msls-val best R@1 = 0.8378, current R@1 = 0.8676
2024-05-01 14:37:42   Start training epoch: 02
2024-05-01 14:56:06   Finished epoch 02 in 0:18:24, average epoch loss = 0.3678
2024-05-01 14:57:03   Ranking results: msls_val R@1: 0.8865, R@5: 0.9365, R@10: 0.9486, R@15: 0.9581, R@20: 0.9595, R@50: 0.9662, R@100: 0.9662
2024-05-01 14:57:11   Improved: previous msls-val best R@1 = 0.8676, current R@1 = 0.8865
2024-05-01 14:57:11   Start training epoch: 03
2024-05-01 15:15:24   Finished epoch 03 in 0:18:13, average epoch loss = 0.3156
2024-05-01 15:16:21   Ranking results: msls_val R@1: 0.8892, R@5: 0.9432, R@10: 0.9500, R@15: 0.9554, R@20: 0.9595, R@50: 0.9676, R@100: 0.9730
2024-05-01 15:16:27   Improved: previous msls-val best R@1 = 0.8865, current R@1 = 0.8892
2024-05-01 15:16:27   Start training epoch: 04
2024-05-01 15:34:39   Finished epoch 04 in 0:18:12, average epoch loss = 0.2880
2024-05-01 15:35:36   Ranking results: msls_val R@1: 0.8905, R@5: 0.9432, R@10: 0.9541, R@15: 0.9595, R@20: 0.9635, R@50: 0.9649, R@100: 0.9716
2024-05-01 15:35:42   Improved: previous msls-val best R@1 = 0.8892, current R@1 = 0.8905
2024-05-01 15:35:42   Start training epoch: 05
2024-05-01 15:53:53   Finished epoch 05 in 0:18:11, average epoch loss = 0.2734
2024-05-01 15:54:50   Ranking results: msls_val R@1: 0.8905, R@5: 0.9432, R@10: 0.9514, R@15: 0.9568, R@20: 0.9608, R@50: 0.9716, R@100: 0.9757
2024-05-01 15:54:53   Not improved: 1 / 3: msls-val best R@1 = 0.8905, current R@1 = 0.8905
2024-05-01 15:54:53   Start training epoch: 06
2024-05-01 16:13:05   Finished epoch 06 in 0:18:11, average epoch loss = 0.2475
2024-05-01 16:14:01   Ranking results: msls_val R@1: 0.8919, R@5: 0.9432, R@10: 0.9541, R@15: 0.9622, R@20: 0.9649, R@50: 0.9703, R@100: 0.9730
2024-05-01 16:14:08   Improved: previous msls-val best R@1 = 0.8905, current R@1 = 0.8919
2024-05-01 16:14:08   Start training epoch: 07
2024-05-01 16:32:17   Finished epoch 07 in 0:18:08, average epoch loss = 0.2345
2024-05-01 16:33:13   Ranking results: msls_val R@1: 0.8851, R@5: 0.9459, R@10: 0.9581, R@15: 0.9608, R@20: 0.9622, R@50: 0.9730, R@100: 0.9730
2024-05-01 16:33:16   Not improved: 1 / 3: msls-val best R@1 = 0.8919, current R@1 = 0.8851
2024-05-01 16:33:16   Start training epoch: 08
2024-05-01 16:51:27   Finished epoch 08 in 0:18:10, average epoch loss = 0.2220
2024-05-01 16:52:23   Ranking results: msls_val R@1: 0.8932, R@5: 0.9432, R@10: 0.9581, R@15: 0.9635, R@20: 0.9676, R@50: 0.9716, R@100: 0.9770
2024-05-01 16:52:30   Improved: previous msls-val best R@1 = 0.8919, current R@1 = 0.8932
2024-05-01 16:52:30   Start training epoch: 09
2024-05-01 17:10:41   Finished epoch 09 in 0:18:10, average epoch loss = 0.2117
2024-05-01 17:11:37   Ranking results: msls_val R@1: 0.8986, R@5: 0.9486, R@10: 0.9581, R@15: 0.9635, R@20: 0.9662, R@50: 0.9743, R@100: 0.9757
2024-05-01 17:11:44   Improved: previous msls-val best R@1 = 0.8932, current R@1 = 0.8986
2024-05-01 17:11:44   Start training epoch: 10
2024-05-01 17:29:57   Finished epoch 10 in 0:18:13, average epoch loss = 0.2021
2024-05-01 17:30:54   Ranking results: msls_val R@1: 0.8851, R@5: 0.9473, R@10: 0.9541, R@15: 0.9622, R@20: 0.9662, R@50: 0.9703, R@100: 0.9743
2024-05-01 17:30:57   Not improved: 1 / 3: msls-val best R@1 = 0.8986, current R@1 = 0.8851
2024-05-01 17:30:57   Start training epoch: 11
2024-05-01 17:49:11   Finished epoch 11 in 0:18:13, average epoch loss = 0.1956
2024-05-01 17:50:09   Ranking results: msls_val R@1: 0.8932, R@5: 0.9419, R@10: 0.9541, R@15: 0.9622, R@20: 0.9635, R@50: 0.9743, R@100: 0.9757
2024-05-01 17:50:12   Not improved: 2 / 3: msls-val best R@1 = 0.8986, current R@1 = 0.8932
2024-05-01 17:50:12   Start training epoch: 12
2024-05-01 18:08:27   Finished epoch 12 in 0:18:15, average epoch loss = 0.1905
2024-05-01 18:09:24   Ranking results: msls_val R@1: 0.8919, R@5: 0.9378, R@10: 0.9541, R@15: 0.9608, R@20: 0.9662, R@50: 0.9716, R@100: 0.9757
2024-05-01 18:09:28   Not improved: 3 / 3: msls-val best R@1 = 0.8986, current R@1 = 0.8919
2024-05-01 18:09:28   Performance did not improve for 3 epochs. Stop training.
2024-05-01 18:09:28   Best  msls-val best R@1 = 0.8986
2024-05-01 18:09:28   Trained for 13 epochs, in total in 4:10:22
2024-05-01 18:09:28   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 18:09:28   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-01 18:09:28   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-01 18:09:29   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-01 18:09:29   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-01 18:09:29   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-01 18:09:29   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-01 18:09:30   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-01 18:09:30   Test *best* model on test set
2024-05-01 18:10:27   Ranking results: msls_val R@1: 0.8986, R@5: 0.9486, R@10: 0.9581, R@15: 0.9635, R@20: 0.9662, R@50: 0.9743, R@100: 0.9757
2024-05-01 18:16:41   Ranking results: tokyo247 R@1: 0.8416, R@5: 0.9220, R@10: 0.9338, R@15: 0.9385, R@20: 0.9433, R@50: 0.9598, R@100: 0.9669
2024-05-01 18:16:46   Ranking results: SPED R@1: 0.8731, R@5: 0.9325, R@10: 0.9473, R@15: 0.9555, R@20: 0.9654, R@50: 0.9802, R@100: 0.9835
2024-05-01 18:18:19   Ranking results: nordland R@1: 0.5351, R@5: 0.6935, R@10: 0.7514, R@15: 0.7830, R@20: 0.8058, R@50: 0.8670, R@100: 0.9047
2024-05-01 18:19:19   Ranking results: pitts30k_val R@1: 0.9453, R@5: 0.9871, R@10: 0.9942, R@15: 0.9962, R@20: 0.9974, R@50: 0.9996, R@100: 1.0000
2024-05-01 18:20:16   Ranking results: pitts30k_test R@1: 0.9184, R@5: 0.9550, R@10: 0.9680, R@15: 0.9746, R@20: 0.9790, R@50: 0.9862, R@100: 0.9919
2024-05-01 18:26:04   Ranking results: pitts250k_test R@1: 0.9479, R@5: 0.9809, R@10: 0.9894, R@15: 0.9924, R@20: 0.9948, R@50: 0.9971, R@100: 0.9983
2024-05-01 18:31:16   Ranking results: pitts250k_val R@1: 0.9432, R@5: 0.9854, R@10: 0.9919, R@15: 0.9947, R@20: 0.9962, R@50: 0.9984, R@100: 0.9989
2024-05-01 18:31:16   Test *last* model on test set
2024-05-01 18:32:13   Ranking results: msls_val R@1: 0.8919, R@5: 0.9378, R@10: 0.9541, R@15: 0.9608, R@20: 0.9662, R@50: 0.9716, R@100: 0.9757
2024-05-01 18:38:28   Ranking results: tokyo247 R@1: 0.8392, R@5: 0.9054, R@10: 0.9220, R@15: 0.9267, R@20: 0.9314, R@50: 0.9504, R@100: 0.9622
2024-05-01 18:38:33   Ranking results: SPED R@1: 0.8797, R@5: 0.9341, R@10: 0.9473, R@15: 0.9572, R@20: 0.9638, R@50: 0.9786, R@100: 0.9852
2024-05-01 18:40:06   Ranking results: nordland R@1: 0.5333, R@5: 0.6989, R@10: 0.7522, R@15: 0.7812, R@20: 0.8047, R@50: 0.8667, R@100: 0.9069
2024-05-01 18:41:05   Ranking results: pitts30k_val R@1: 0.9436, R@5: 0.9875, R@10: 0.9943, R@15: 0.9961, R@20: 0.9972, R@50: 0.9993, R@100: 1.0000
2024-05-01 18:42:02   Ranking results: pitts30k_test R@1: 0.9190, R@5: 0.9542, R@10: 0.9670, R@15: 0.9733, R@20: 0.9765, R@50: 0.9849, R@100: 0.9903
2024-05-01 18:47:46   Ranking results: pitts250k_test R@1: 0.9502, R@5: 0.9813, R@10: 0.9894, R@15: 0.9919, R@20: 0.9940, R@50: 0.9965, R@100: 0.9978
2024-05-01 18:53:00   Ranking results: pitts250k_val R@1: 0.9412, R@5: 0.9855, R@10: 0.9919, R@15: 0.9942, R@20: 0.9954, R@50: 0.9991, R@100: 0.9996
