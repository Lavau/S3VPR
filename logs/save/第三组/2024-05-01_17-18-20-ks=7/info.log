2024-05-01 17:18:20   Arguments: Namespace(aggregator_name='token_module', backbone_name='dinov2', device='cuda', dim=768, epochs_num=80, foundation_model_path='pth/dinov2_vitb14_pretrain.pth', infer_batch_size=300, kernel_size=7, lr=0.0001, mlp_ratio=0.75, nc=4096, num_trainable_blocks=4, num_workers=4, optim='adam', patience=3, recall_values=[1, 5, 10, 100], resize=[224, 224], save_dir='logs/2024-05-01_17-18-20', seed=0, train_batch_size=50, val_set_names=['msls_val'])
2024-05-01 17:18:20   The outputs are being saved in logs/2024-05-01_17-18-20
2024-05-01 17:18:20   validation dataset names:['msls_val']
2024-05-01 17:18:20   Using 2 GPUs and 64 CPUs
2024-05-01 17:18:20   using MLP layer as FFN
2024-05-01 17:18:24   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 17:18:24   Start training epoch: 00
2024-05-01 17:48:04   Finished epoch 00 in 0:29:39, average epoch loss = 0.5641
2024-05-01 17:49:15   Ranking results: msls_val R@1: 0.8351, R@5: 0.9230, R@10: 0.9365, R@15: 0.9446, R@20: 0.9527, R@50: 0.9608, R@100: 0.9662
2024-05-01 17:49:17   Improved: previous msls-val best R@1 = 0.0000, current R@1 = 0.8351
2024-05-01 17:49:17   Start training epoch: 01
2024-05-01 18:18:53   Finished epoch 01 in 0:29:35, average epoch loss = 0.3445
2024-05-01 18:20:02   Ranking results: msls_val R@1: 0.8405, R@5: 0.9122, R@10: 0.9284, R@15: 0.9378, R@20: 0.9446, R@50: 0.9608, R@100: 0.9649
2024-05-01 18:20:08   Improved: previous msls-val best R@1 = 0.8351, current R@1 = 0.8405
2024-05-01 18:20:08   Start training epoch: 02
2024-05-01 18:49:43   Finished epoch 02 in 0:29:34, average epoch loss = 0.3092
2024-05-01 18:50:52   Ranking results: msls_val R@1: 0.8500, R@5: 0.9149, R@10: 0.9324, R@15: 0.9432, R@20: 0.9500, R@50: 0.9649, R@100: 0.9784
2024-05-01 18:50:59   Improved: previous msls-val best R@1 = 0.8405, current R@1 = 0.8500
2024-05-01 18:50:59   Start training epoch: 03
2024-05-01 19:20:32   Finished epoch 03 in 0:29:33, average epoch loss = 0.2570
2024-05-01 19:21:41   Ranking results: msls_val R@1: 0.8676, R@5: 0.9297, R@10: 0.9459, R@15: 0.9554, R@20: 0.9595, R@50: 0.9703, R@100: 0.9730
2024-05-01 19:21:48   Improved: previous msls-val best R@1 = 0.8500, current R@1 = 0.8676
2024-05-01 19:21:48   Start training epoch: 04
2024-05-01 19:51:20   Finished epoch 04 in 0:29:32, average epoch loss = 0.2316
2024-05-01 19:52:29   Ranking results: msls_val R@1: 0.8689, R@5: 0.9338, R@10: 0.9500, R@15: 0.9554, R@20: 0.9581, R@50: 0.9730, R@100: 0.9784
2024-05-01 19:52:35   Improved: previous msls-val best R@1 = 0.8676, current R@1 = 0.8689
2024-05-01 19:52:35   Start training epoch: 05
2024-05-01 20:22:07   Finished epoch 05 in 0:29:32, average epoch loss = 0.2219
2024-05-01 20:23:16   Ranking results: msls_val R@1: 0.8757, R@5: 0.9365, R@10: 0.9486, R@15: 0.9595, R@20: 0.9622, R@50: 0.9676, R@100: 0.9716
2024-05-01 20:23:24   Improved: previous msls-val best R@1 = 0.8689, current R@1 = 0.8757
2024-05-01 20:23:24   Start training epoch: 06
2024-05-01 20:52:56   Finished epoch 06 in 0:29:32, average epoch loss = 0.1916
2024-05-01 20:54:04   Ranking results: msls_val R@1: 0.8797, R@5: 0.9419, R@10: 0.9473, R@15: 0.9568, R@20: 0.9622, R@50: 0.9716, R@100: 0.9784
2024-05-01 20:54:11   Improved: previous msls-val best R@1 = 0.8757, current R@1 = 0.8797
2024-05-01 20:54:11   Start training epoch: 07
2024-05-01 21:23:43   Finished epoch 07 in 0:29:31, average epoch loss = 0.1801
2024-05-01 21:24:52   Ranking results: msls_val R@1: 0.8743, R@5: 0.9338, R@10: 0.9486, R@15: 0.9568, R@20: 0.9595, R@50: 0.9703, R@100: 0.9743
2024-05-01 21:24:56   Not improved: 1 / 3: msls-val best R@1 = 0.8797, current R@1 = 0.8743
2024-05-01 21:24:56   Start training epoch: 08
2024-05-01 21:54:27   Finished epoch 08 in 0:29:30, average epoch loss = 0.1708
2024-05-01 21:55:35   Ranking results: msls_val R@1: 0.8743, R@5: 0.9351, R@10: 0.9500, R@15: 0.9595, R@20: 0.9662, R@50: 0.9689, R@100: 0.9743
2024-05-01 21:55:39   Not improved: 2 / 3: msls-val best R@1 = 0.8797, current R@1 = 0.8743
2024-05-01 21:55:39   Start training epoch: 09
2024-05-01 22:25:10   Finished epoch 09 in 0:29:30, average epoch loss = 0.1572
2024-05-01 22:26:18   Ranking results: msls_val R@1: 0.8730, R@5: 0.9365, R@10: 0.9473, R@15: 0.9568, R@20: 0.9622, R@50: 0.9716, R@100: 0.9730
2024-05-01 22:26:22   Not improved: 3 / 3: msls-val best R@1 = 0.8797, current R@1 = 0.8730
2024-05-01 22:26:22   Performance did not improve for 3 epochs. Stop training.
2024-05-01 22:26:22   Best  msls-val best R@1 = 0.8797
2024-05-01 22:26:22   Trained for 10 epochs, in total in 5:08:02
2024-05-01 22:26:22   Val set: < MSLS, msls-val - #database: 18871; #queries: 747 >
2024-05-01 22:26:22   Val set: < Tokyo247Dataset, Tokyo - #database: 75984; #queries: 423 >
2024-05-01 22:26:22   Val set: < SPEDDataset, SPED - #database: 607; #queries: 607 >
2024-05-01 22:26:22   Val set: < NordlandDataset, nordland - #database: 27592; #queries: 2760 >
2024-05-01 22:26:22   Val set: < WholeDatasetFromStruct, pitts30k_val - #database: 10000; #queries: 7608 >
2024-05-01 22:26:22   Val set: < WholeDatasetFromStruct, pitts30k_test - #database: 10000; #queries: 6816 >
2024-05-01 22:26:23   Val set: < WholeDatasetFromStruct, pitts250k_test - #database: 83952; #queries: 8280 >
2024-05-01 22:26:24   Val set: < WholeDatasetFromStruct, pitts250k_val - #database: 78648; #queries: 7608 >
2024-05-01 22:26:24   Test *best* model on test set
2024-05-01 22:27:33   Ranking results: msls_val R@1: 0.8797, R@5: 0.9419, R@10: 0.9473, R@15: 0.9568, R@20: 0.9622, R@50: 0.9716, R@100: 0.9784
2024-05-01 22:33:39   Ranking results: tokyo247 R@1: 0.7494, R@5: 0.8605, R@10: 0.8842, R@15: 0.8913, R@20: 0.8983, R@50: 0.9149, R@100: 0.9385
2024-05-01 22:33:45   Ranking results: SPED R@1: 0.8600, R@5: 0.9259, R@10: 0.9456, R@15: 0.9572, R@20: 0.9605, R@50: 0.9687, R@100: 0.9802
2024-05-01 22:35:37   Ranking results: nordland R@1: 0.5123, R@5: 0.6909, R@10: 0.7478, R@15: 0.7750, R@20: 0.7942, R@50: 0.8609, R@100: 0.8993
2024-05-01 22:36:47   Ranking results: pitts30k_val R@1: 0.9357, R@5: 0.9828, R@10: 0.9903, R@15: 0.9937, R@20: 0.9950, R@50: 0.9984, R@100: 0.9995
2024-05-01 22:37:54   Ranking results: pitts30k_test R@1: 0.8992, R@5: 0.9448, R@10: 0.9589, R@15: 0.9664, R@20: 0.9702, R@50: 0.9822, R@100: 0.9858
2024-05-01 22:44:32   Ranking results: pitts250k_test R@1: 0.9304, R@5: 0.9707, R@10: 0.9801, R@15: 0.9847, R@20: 0.9873, R@50: 0.9937, R@100: 0.9954
2024-05-01 22:50:36   Ranking results: pitts250k_val R@1: 0.9309, R@5: 0.9758, R@10: 0.9846, R@15: 0.9887, R@20: 0.9908, R@50: 0.9957, R@100: 0.9983
2024-05-01 22:50:36   Test *last* model on test set
2024-05-01 22:51:46   Ranking results: msls_val R@1: 0.8730, R@5: 0.9365, R@10: 0.9473, R@15: 0.9568, R@20: 0.9622, R@50: 0.9716, R@100: 0.9730
2024-05-01 22:57:51   Ranking results: tokyo247 R@1: 0.7660, R@5: 0.8676, R@10: 0.8913, R@15: 0.9007, R@20: 0.9125, R@50: 0.9291, R@100: 0.9456
2024-05-01 22:57:57   Ranking results: SPED R@1: 0.8583, R@5: 0.9259, R@10: 0.9489, R@15: 0.9539, R@20: 0.9605, R@50: 0.9720, R@100: 0.9819
2024-05-01 22:59:48   Ranking results: nordland R@1: 0.5134, R@5: 0.7029, R@10: 0.7652, R@15: 0.7957, R@20: 0.8141, R@50: 0.8750, R@100: 0.9134
2024-05-01 23:01:00   Ranking results: pitts30k_val R@1: 0.9355, R@5: 0.9838, R@10: 0.9913, R@15: 0.9937, R@20: 0.9947, R@50: 0.9975, R@100: 0.9989
2024-05-01 23:02:07   Ranking results: pitts30k_test R@1: 0.9032, R@5: 0.9482, R@10: 0.9626, R@15: 0.9701, R@20: 0.9740, R@50: 0.9836, R@100: 0.9887
2024-05-01 23:08:47   Ranking results: pitts250k_test R@1: 0.9310, R@5: 0.9732, R@10: 0.9826, R@15: 0.9879, R@20: 0.9905, R@50: 0.9950, R@100: 0.9967
2024-05-01 23:14:52   Ranking results: pitts250k_val R@1: 0.9319, R@5: 0.9782, R@10: 0.9861, R@15: 0.9894, R@20: 0.9915, R@50: 0.9949, R@100: 0.9975
